<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\x53\x45\120\x41\x54\110") or exit("\x4e\x6f\x20\x64\x69\x72\145\143\164\40\x73\143\x72\151\x70\164\40\x61\143\143\145\x73\x73\x20\x61\x6c\154\157\x77\x65\144"); class Ion_auth_model extends CI_Model { const MAX_COOKIE_LIFETIME = 63072000; const MAX_PASSWORD_SIZE_BYTES = 4096; public $tables = array(); public $activation_code; public $new_password; public $identity; public $_ion_where = array(); public $_ion_select = array(); public $_ion_like = array(); public $_ion_limit = NULL; public $_ion_offset = NULL; public $_ion_order_by = NULL; public $_ion_order = NULL; protected $_ion_hooks; protected $response = NULL; protected $messages; protected $errors; protected $error_start_delimiter; protected $error_end_delimiter; public $_cache_user_in_group = array(); protected $_cache_groups = array(); protected $db; public function __construct() { goto tAuTS; tAuTS: $this->config->load("\151\157\156\137\141\x75\164\x68", TRUE); goto nzX9Q; J4C0i: xdq_O: goto v6brv; vHIxd: if (empty($group_name)) { goto xdq_O; } goto PrEpQ; dFHgg: $this->hash_method = $this->config->item("\x68\141\x73\x68\x5f\155\x65\x74\x68\x6f\x64", "\x69\x6f\x6e\137\141\x75\164\x68"); goto C3Jsl; tTL8Q: $this->lang->load("\x69\x6f\x6e\137\141\x75\164\150"); goto zsSq5; blBKG: $this->trigger_events("\155\157\x64\145\x6c\x5f\x63\157\x6e\163\x74\162\x75\143\164\157\x72"); goto MOplV; jMgFY: $form_validation_class = new ReflectionClass("\x43\111\137\x46\x6f\162\x6d\x5f\166\141\x6c\x69\144\x61\x74\x69\157\156"); goto yBPhS; cr5q8: if ($delimiters_source === "\146\x6f\162\x6d\x5f\166\x61\154\x69\144\141\164\x69\157\x6e") { goto FJESL; } goto knyDo; zsSq5: $group_name = $this->config->item("\144\x61\164\141\x62\x61\x73\x65\137\x67\162\157\165\x70\137\156\141\x6d\145", "\x69\x6f\156\x5f\141\165\164\x68"); goto vHIxd; M_F_g: goto WxaJW; goto J4C0i; Fl_WJ: $this->error_start_delimiter = $error_prefix->getValue($this->form_validation); goto v2Aiy; yBPhS: $error_prefix = $form_validation_class->getProperty("\x5f\145\162\x72\157\162\137\x70\162\145\146\x69\170"); goto AUpXl; knyDo: $this->message_start_delimiter = $this->config->item("\155\145\x73\163\141\x67\145\x5f\163\x74\x61\x72\164\x5f\144\x65\x6c\x69\x6d\x69\x74\x65\x72", "\151\157\x6e\x5f\x61\165\x74\150"); goto Eo7lh; O5f7J: $this->tables = $this->config->item("\x74\x61\142\154\145\x73", "\x69\157\156\x5f\141\165\x74\150"); goto mdmMP; C3Jsl: $this->messages = []; goto lAbZH; Csh2Y: FJESL: goto eLnvE; gsO_U: WxaJW: goto O5f7J; nzX9Q: $this->load->helper("\x63\157\157\153\151\145"); goto VGUVg; AUpXl: $error_prefix->setAccessible(TRUE); goto Fl_WJ; QA_x1: $delimiters_source = $this->config->item("\x64\x65\x6c\x69\155\x69\164\x65\x72\163\137\163\157\165\x72\143\145", "\x69\x6f\156\x5f\x61\165\164\x68"); goto cr5q8; PrEpQ: $this->db = $this->load->database($group_name, TRUE, TRUE); goto M_F_g; CI3bu: jlUSO: goto abbJC; mdmMP: $this->identity_column = $this->config->item("\151\x64\x65\156\x74\151\164\171", "\x69\157\156\x5f\x61\x75\164\150"); goto Ty6kL; NlUY_: $this->error_start_delimiter = $this->config->item("\x65\162\162\157\162\137\x73\164\141\162\164\137\x64\145\154\151\x6d\151\164\x65\162", "\x69\x6f\156\x5f\141\x75\x74\150"); goto bVBQJ; eLnvE: $this->load->library("\x66\157\x72\155\x5f\x76\141\154\x69\144\x61\x74\x69\157\156"); goto jMgFY; CJ8fp: $this->db = $CI->db; goto gsO_U; VGUVg: $this->load->helper("\x64\x61\x74\x65"); goto tTL8Q; OYirq: $this->message_end_delimiter = $this->error_end_delimiter; goto CI3bu; bVBQJ: $this->error_end_delimiter = $this->config->item("\x65\162\162\x6f\162\x5f\145\156\x64\137\x64\145\x6c\x69\x6d\151\x74\x65\162", "\151\x6f\156\137\141\x75\164\150"); goto DTBLo; v6brv: $CI =& get_instance(); goto CJ8fp; Ty6kL: $this->join = $this->config->item("\x6a\157\x69\156", "\x69\x6f\x6e\137\x61\x75\x74\x68"); goto dFHgg; v2Aiy: $this->message_start_delimiter = $this->error_start_delimiter; goto oGqCM; DTBLo: goto jlUSO; goto Csh2Y; abbJC: $this->_ion_hooks = new stdClass(); goto blBKG; y63RL: $error_suffix->setAccessible(TRUE); goto Sg1WO; Sg1WO: $this->error_end_delimiter = $error_suffix->getValue($this->form_validation); goto OYirq; oGqCM: $error_suffix = $form_validation_class->getProperty("\x5f\x65\162\x72\157\x72\137\x73\165\x66\146\x69\x78"); goto y63RL; Eo7lh: $this->message_end_delimiter = $this->config->item("\x6d\145\x73\163\x61\147\145\x5f\145\156\x64\x5f\x64\145\x6c\151\x6d\x69\164\145\162", "\x69\x6f\x6e\x5f\141\165\164\150"); goto NlUY_; lAbZH: $this->errors = []; goto QA_x1; MOplV: } public function db() { return $this->db; } public function hash_password($password, $identity = NULL) { goto VNoO5; zCYnn: return FALSE; goto PCLZ7; PCLZ7: baSPw: goto W3qkt; VNoO5: if (!(empty($password) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto baSPw; } goto zCYnn; W3qkt: $algo = $this->_get_hash_algo(); goto bPrMj; fLfs7: return password_hash($password, $algo, $params); goto IiRlL; OPJz4: return FALSE; goto cEIrP; PZCqa: if (!($algo !== FALSE && $params !== FALSE)) { goto QRNif; } goto fLfs7; IiRlL: QRNif: goto OPJz4; bPrMj: $params = $this->_get_hash_parameters($identity); goto PZCqa; cEIrP: } public function verify_password($password, $hash_password_db, $identity = NULL) { goto SUwg_; EzA9s: VD_Bm: goto rxtxl; pL2MC: goto N3e1j; goto EzA9s; g0Mlp: if (strpos($hash_password_db, "\44") === 0) { goto VD_Bm; } goto ajP74; jTPA6: return FALSE; goto OoKta; OoKta: e2d73: goto g0Mlp; e5gLh: N3e1j: goto ygA7S; ajP74: return $this->_password_verify_sha1_legacy($identity, $password, $hash_password_db); goto pL2MC; rxtxl: return password_verify($password, $hash_password_db); goto e5gLh; SUwg_: if (!(empty($password) || empty($hash_password_db) || strpos($password, "\x0") !== FALSE || strlen($password) > self::MAX_PASSWORD_SIZE_BYTES)) { goto e2d73; } goto jTPA6; ygA7S: } public function rehash_password_if_needed($hash, $identity, $password) { goto Japa9; zvB0u: $params = $this->_get_hash_parameters($identity); goto hHRAH; tNhZk: P061l: goto V8G2C; Japa9: $algo = $this->_get_hash_algo(); goto zvB0u; GUvqQ: $this->trigger_events(["\x72\x65\x68\141\163\150\137\160\x61\163\163\x77\x6f\162\144", "\162\x65\150\141\163\x68\x5f\x70\141\x73\163\167\x6f\162\144\137\x75\x6e\x73\165\143\x63\145\163\163\146\x75\154"]); goto I_qlX; a2KvF: sN1Ve: goto tNhZk; NWCY8: $this->trigger_events(["\x72\x65\x68\x61\x73\x68\x5f\160\141\163\163\x77\157\x72\144", "\162\x65\150\141\x73\150\137\x70\141\163\x73\167\157\162\x64\x5f\x73\x75\x63\143\145\163\163\x66\165\154"]); goto f1UcC; f1UcC: DJ5Cv: goto a2KvF; I_qlX: goto DJ5Cv; goto vSgZ_; hHRAH: if (!($algo !== FALSE && $params !== FALSE)) { goto P061l; } goto Xklf3; m4urC: if ($this->_set_password_db($identity, $password)) { goto amcMf; } goto GUvqQ; Xklf3: if (!password_needs_rehash($hash, $algo, $params)) { goto sN1Ve; } goto m4urC; vSgZ_: amcMf: goto NWCY8; V8G2C: } public function get_user_by_activation_code($user_code) { goto wZZfd; hbA3S: return $user; goto W46Nn; upJJd: if (!$user) { goto HSBV9; } goto QvfhT; fK1YY: HSBV9: goto ztfSD; wZZfd: $token = $this->_retrieve_selector_validator_couple($user_code); goto d1SV6; d1SV6: $user = $this->where("\141\x63\x74\151\x76\141\x74\151\x6f\156\x5f\x73\x65\x6c\x65\143\x74\157\x72", $token->selector)->users()->row(); goto upJJd; ztfSD: return FALSE; goto EdlYm; W46Nn: va26E: goto fK1YY; QvfhT: if (!$this->verify_password($token->validator, $user->activation_code)) { goto va26E; } goto hbA3S; EdlYm: } public function activate($id, $code = FALSE) { goto alb0M; MSV7e: $this->set_error("\x61\143\x74\x69\166\x61\164\145\x5f\x75\156\163\x75\x63\x63\145\x73\x73\x66\x75\x6c"); goto r93jB; wQkhy: eM5PS: goto eP08s; vc0Td: XlqRx: goto wplSB; eP08s: if (!($code === FALSE || $user && $user->id === $id)) { goto LgFHn; } goto hsi2v; wplSB: LgFHn: goto JeN85; JeN85: $this->trigger_events(["\160\157\x73\x74\137\x61\x63\x74\151\166\141\x74\x65", "\x70\157\163\164\x5f\x61\x63\x74\151\x76\x61\164\x65\137\165\156\x73\x75\x63\143\145\163\x73\x66\x75\154"]); goto MSV7e; B7bkR: $this->db->update($this->tables["\x75\163\x65\162\x73"], $data, ["\x69\144" => $id]); goto FRLHT; hsi2v: $data = ["\x61\x63\x74\151\166\141\x74\151\157\x6e\x5f\163\x65\x6c\145\143\x74\157\162" => NULL, "\x61\x63\164\151\x76\x61\164\x69\157\156\137\143\x6f\x64\145" => NULL, "\x61\x63\x74\x69\166\x65" => 1]; goto LjTXo; YznLH: $this->trigger_events(["\x70\157\163\164\137\141\143\164\x69\x76\x61\164\x65", "\x70\157\x73\164\x5f\141\x63\x74\151\x76\x61\164\145\137\163\165\x63\143\145\163\163\x66\165\154"]); goto Q8PZ5; alb0M: $this->trigger_events("\x70\162\145\x5f\x61\143\164\151\166\141\x74\145"); goto fOdcp; fOdcp: if (!($code !== FALSE)) { goto eM5PS; } goto V8awn; LjTXo: $this->trigger_events("\x65\x78\x74\162\x61\x5f\167\x68\145\x72\145"); goto B7bkR; V8awn: $user = $this->get_user_by_activation_code($code); goto wQkhy; FRLHT: if (!($this->db->affected_rows() === 1)) { goto XlqRx; } goto YznLH; UKsHF: return TRUE; goto vc0Td; Q8PZ5: $this->set_message("\141\143\164\151\166\141\164\x65\x5f\163\x75\x63\x63\x65\x73\x73\146\165\x6c"); goto UKsHF; r93jB: return FALSE; goto wWzK8; wWzK8: } public function deactivate($id = NULL) { goto yjaTJ; nNz8v: if (!($this->ion_auth->logged_in() && $this->user()->row()->id == $id)) { goto QJC1C; } goto zEp20; zEp20: $this->set_error("\x64\145\x61\x63\164\151\166\x61\164\x65\137\x63\x75\162\162\145\x6e\x74\137\165\x73\x65\162\x5f\165\156\163\x75\143\143\145\x73\163\x66\165\x6c"); goto MGqJj; Raf5R: goto DZy4G; goto pplz9; LQ_fC: return FALSE; goto tIf33; hydNQ: $token = $this->_generate_selector_validator_couple(20, 40); goto Q89Gn; dmjIX: $return = $this->db->affected_rows() == 1; goto a0UCA; WN3_2: return $return; goto P08Vh; Q89Gn: $this->activation_code = $token->user_code; goto oJEEs; tIf33: DZy4G: goto hydNQ; a0UCA: if ($return) { goto raFDg; } goto z5qdE; nCzXv: QJC1C: goto Raf5R; MGqJj: return FALSE; goto nCzXv; ECYWp: $this->set_error("\144\x65\x61\143\164\x69\x76\141\164\145\x5f\x75\x6e\x73\x75\x63\143\145\163\x73\x66\x75\154"); goto LQ_fC; pplz9: yXR7X: goto ECYWp; oJEEs: $data = ["\x61\143\x74\x69\166\x61\x74\151\x6f\156\137\163\x65\x6c\x65\143\x74\x6f\x72" => $token->selector, "\141\143\x74\x69\166\141\164\x69\x6f\156\x5f\143\157\x64\145" => $token->validator_hashed, "\141\143\164\x69\166\x65" => 0]; goto LOcmE; AfOA3: goto n0gXm; goto VFAMr; yjaTJ: $this->trigger_events("\144\145\x61\x63\x74\151\166\141\x74\145"); goto gC9xY; ITt7b: $this->db->update($this->tables["\x75\x73\x65\x72\163"], $data, ["\151\x64" => $id]); goto dmjIX; IXIUC: $this->set_message("\x64\x65\141\x63\x74\x69\166\x61\x74\145\x5f\x73\x75\143\x63\x65\163\x73\x66\165\x6c"); goto jV70A; LOcmE: $this->trigger_events("\x65\170\164\x72\141\x5f\x77\150\145\x72\145"); goto ITt7b; VFAMr: raFDg: goto IXIUC; z5qdE: $this->set_error("\x64\145\x61\143\164\x69\x76\x61\164\145\137\x75\156\163\165\143\143\x65\x73\163\146\165\x6c"); goto AfOA3; jV70A: n0gXm: goto WN3_2; gC9xY: if (!isset($id)) { goto yXR7X; } goto nNz8v; P08Vh: } public function clear_forgotten_password_code($identity) { goto V3vuC; SJobe: return FALSE; goto w8Gu9; dfdMT: $data = ["\x66\157\162\x67\157\164\164\x65\156\137\x70\141\x73\x73\x77\x6f\162\x64\137\x73\x65\154\x65\143\x74\x6f\x72" => NULL, "\x66\157\x72\147\x6f\164\x74\145\156\x5f\160\141\163\163\167\157\162\144\x5f\x63\x6f\x64\x65" => NULL, "\x66\x6f\162\x67\x6f\164\164\145\156\137\x70\141\x73\x73\x77\157\162\x64\137\164\151\155\x65" => NULL]; goto WJlAG; WJlAG: $this->db->update($this->tables["\165\x73\145\x72\163"], $data, [$this->identity_column => $identity]); goto TWMLi; TWMLi: return TRUE; goto wuJTK; w8Gu9: t_Cgc: goto dfdMT; V3vuC: if (!empty($identity)) { goto t_Cgc; } goto SJobe; wuJTK: } public function clear_remember_code($identity) { goto IEpiX; IEpiX: if (!empty($identity)) { goto ikD6B; } goto jIxoY; jIxoY: return FALSE; goto I1z2J; I1z2J: ikD6B: goto Ckrnz; J19O2: return TRUE; goto Kl5hT; Ckrnz: $data = ["\162\x65\x6d\x65\155\142\145\x72\x5f\163\x65\154\x65\143\x74\x6f\x72" => NULL, "\162\x65\x6d\x65\x6d\142\x65\x72\137\x63\x6f\x64\x65" => NULL]; goto B4HXc; B4HXc: $this->db->update($this->tables["\165\163\x65\162\x73"], $data, [$this->identity_column => $identity]); goto J19O2; Kl5hT: } public function reset_password($identity, $new) { goto Z_6r3; EEjRU: $this->trigger_events(["\x70\157\x73\164\137\x63\150\x61\156\x67\x65\x5f\x70\x61\163\163\x77\157\x72\144", "\x70\157\x73\x74\137\x63\x68\141\156\x67\145\137\160\x61\163\163\167\157\x72\144\x5f\165\x6e\x73\x75\143\143\x65\163\x73\x66\165\154"]); goto gxuih; Z_6r3: $this->trigger_events("\160\162\x65\x5f\x63\150\141\156\x67\145\x5f\x70\141\163\x73\x77\157\x72\x64"); goto mjK2F; gxuih: $this->set_error("\160\x61\163\x73\x77\157\x72\x64\137\x63\x68\x61\156\x67\x65\137\165\156\163\165\x63\143\145\163\x73\146\x75\154"); goto uSOOH; jciKv: lCKOc: goto Csxt0; r1_jl: return $return; goto AzA73; W2KnQ: dsVIr: goto DMa8i; UJJnM: $this->trigger_events(["\160\x6f\x73\164\x5f\x63\x68\141\156\x67\145\137\x70\141\x73\163\x77\x6f\162\144", "\160\x6f\163\164\137\143\x68\141\156\147\145\x5f\x70\141\x73\163\x77\157\x72\144\137\x75\156\163\165\x63\143\x65\x73\x73\x66\x75\x6c"]); goto mfxQn; DMa8i: $this->trigger_events(["\160\x6f\163\x74\137\143\x68\x61\x6e\147\x65\137\x70\141\163\x73\x77\x6f\162\x64", "\160\157\163\x74\137\143\150\x61\156\147\145\x5f\160\141\163\x73\x77\157\x72\144\137\163\165\x63\x63\145\x73\x73\x66\165\x6c"]); goto CdaaF; mjK2F: if ($this->identity_check($identity)) { goto lCKOc; } goto UJJnM; mfxQn: return FALSE; goto jciKv; Csxt0: $return = $this->_set_password_db($identity, $new); goto jH94A; jH94A: if ($return) { goto dsVIr; } goto EEjRU; uSOOH: goto PK86P; goto W2KnQ; CdaaF: $this->set_message("\160\141\163\163\167\157\x72\x64\137\143\x68\x61\156\x67\145\x5f\x73\165\x63\x63\145\163\163\146\165\154"); goto hQNX1; hQNX1: PK86P: goto r1_jl; AzA73: } public function change_password($identity, $old, $new) { goto qeTDU; RThAr: $this->set_error("\160\141\163\x73\167\157\162\144\137\x63\150\x61\156\147\145\x5f\165\156\x73\x75\143\x63\145\163\x73\146\165\x6c"); goto jw_hj; Ri2qM: $this->trigger_events(["\x70\157\x73\x74\x5f\x63\x68\141\x6e\x67\145\137\160\141\x73\163\167\x6f\162\x64", "\x70\x6f\163\x74\137\x63\150\141\156\x67\145\x5f\x70\x61\163\x73\167\157\162\144\x5f\x73\165\x63\x63\145\163\163\146\x75\154"]); goto Fu4Me; pXbkn: $this->trigger_events("\145\170\164\x72\x61\137\x77\x68\145\x72\145"); goto MclAz; Do4FC: return FALSE; goto rQ6Og; z2jhT: if (!($query->num_rows() !== 1)) { goto FZC3f; } goto Oy9KJ; OxEIy: vZkSz: goto Ri2qM; zv8Xd: E2PR7: goto MXX72; d7UBx: $user = $query->row(); goto eg1B2; pVmvj: if ($result) { goto vZkSz; } goto Mu6iO; wLE7B: goto vUIhz; goto OxEIy; lg6v1: FZC3f: goto d7UBx; MXX72: $this->set_error("\160\x61\163\x73\x77\157\162\x64\137\143\x68\x61\156\147\x65\x5f\x75\x6e\x73\x75\143\143\x65\163\x73\146\165\154"); goto Do4FC; jw_hj: return FALSE; goto lg6v1; rv0Uv: $result = $this->_set_password_db($identity, $new); goto pVmvj; Oy9KJ: $this->trigger_events(["\160\x6f\x73\164\x5f\x63\x68\141\156\x67\x65\137\160\141\x73\163\x77\157\162\144", "\x70\x6f\163\164\137\x63\150\141\x6e\x67\145\137\x70\141\x73\163\167\x6f\162\x64\x5f\x75\156\x73\165\x63\x63\x65\x73\163\146\x75\x6c"]); goto RThAr; eg1B2: if (!$this->verify_password($old, $user->password, $identity)) { goto E2PR7; } goto rv0Uv; vOFpB: vUIhz: goto d0s32; d0s32: return $result; goto zv8Xd; Mu6iO: $this->trigger_events(["\x70\x6f\163\x74\137\143\x68\141\x6e\147\x65\137\x70\x61\x73\x73\x77\157\162\x64", "\x70\x6f\163\x74\137\143\x68\x61\156\x67\x65\137\x70\x61\163\x73\167\157\x72\x64\137\x75\x6e\x73\165\x63\143\x65\163\163\x66\x75\x6c"]); goto Vl1eh; Vl1eh: $this->set_error("\160\x61\163\163\167\x6f\x72\x64\x5f\x63\x68\x61\x6e\147\145\x5f\x75\x6e\x73\x75\x63\143\x65\163\x73\x66\165\x6c"); goto wLE7B; qeTDU: $this->trigger_events("\x70\x72\x65\x5f\x63\x68\x61\156\x67\x65\x5f\160\141\163\x73\167\x6f\162\x64"); goto pXbkn; MclAz: $query = $this->db->select("\151\x64\54\x20\x70\141\163\x73\167\x6f\x72\144")->where($this->identity_column, $identity)->limit(1)->order_by("\x69\x64", "\144\145\x73\x63")->get($this->tables["\165\163\145\162\163"]); goto z2jhT; Fu4Me: $this->set_message("\160\141\163\x73\x77\x6f\162\144\137\x63\150\141\156\x67\x65\137\163\x75\143\143\x65\x73\163\x66\165\x6c"); goto vOFpB; rQ6Og: } public function username_check($username = '') { goto UY4Ta; u3MVS: return $this->db->where("\165\x73\145\162\x6e\141\155\x65", $username)->limit(1)->count_all_results($this->tables["\165\163\x65\162\x73"]) > 0; goto DRp0f; Vug7G: $this->trigger_events("\145\x78\x74\x72\x61\137\x77\150\x65\x72\x65"); goto u3MVS; XwG95: aXb5T: goto Vug7G; UY4Ta: $this->trigger_events("\165\x73\x65\162\156\141\x6d\x65\x5f\143\150\145\x63\153"); goto s1efX; s1efX: if (!empty($username)) { goto aXb5T; } goto f1deL; f1deL: return FALSE; goto XwG95; DRp0f: } public function email_check($email = '') { goto G2TbA; gDVL1: return FALSE; goto ZH8Tn; G2TbA: $this->trigger_events("\145\x6d\x61\151\x6c\137\x63\150\145\x63\x6b"); goto GpACh; i8sZ8: $this->trigger_events("\145\x78\164\162\x61\137\x77\x68\x65\x72\145"); goto oIPQm; oIPQm: return $this->db->where("\145\x6d\141\151\154", $email)->limit(1)->count_all_results($this->tables["\x75\x73\145\x72\163"]) > 0; goto zh3DC; ZH8Tn: Q8cRJ: goto i8sZ8; GpACh: if (!empty($email)) { goto Q8cRJ; } goto gDVL1; zh3DC: } public function identity_check($identity = '') { goto mPKeh; qOwWw: return FALSE; goto Ds4NN; a5S_f: return $this->db->where($this->identity_column, $identity)->limit(1)->count_all_results($this->tables["\x75\163\145\162\x73"]) > 0; goto pS91w; Ds4NN: MR4Fm: goto a5S_f; mPKeh: $this->trigger_events("\151\x64\x65\x6e\x74\151\x74\171\x5f\143\x68\x65\143\153"); goto BqiXz; BqiXz: if (!empty($identity)) { goto MR4Fm; } goto qOwWw; pS91w: } public function get_user_id_from_identity($identity = '') { goto UVhx0; pKMZp: hmLmd: goto NSoWa; wzoCx: cyNGr: goto nJ4wW; UVhx0: if (!empty($identity)) { goto cyNGr; } goto ArGYT; nJ4wW: $query = $this->db->select("\151\144")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\165\163\145\x72\x73"]); goto WjtcB; ArGYT: return FALSE; goto wzoCx; aEI8s: return $user->id; goto jcz9d; KxKwY: return FALSE; goto pKMZp; WjtcB: if (!($query->num_rows() !== 1)) { goto hmLmd; } goto KxKwY; NSoWa: $user = $query->row(); goto aEI8s; jcz9d: } public function forgotten_password($identity) { goto zYenW; UNoMr: $update = ["\146\157\162\x67\157\x74\164\x65\x6e\x5f\x70\x61\163\x73\167\157\162\x64\x5f\x73\x65\x6c\145\143\164\157\x72" => $token->selector, "\x66\x6f\162\x67\157\x74\164\145\156\x5f\160\141\163\x73\167\x6f\x72\x64\137\143\x6f\x64\x65" => $token->validator_hashed, "\x66\x6f\x72\x67\x6f\x74\x74\145\156\137\x70\141\x73\x73\x77\x6f\x72\144\x5f\164\151\155\x65" => time()]; goto e3k7T; G2fH3: $token = $this->_generate_selector_validator_couple(20, 80); goto UNoMr; QbPoD: if ($this->db->affected_rows() === 1) { goto IMlI_; } goto DRaSp; zYenW: if (!empty($identity)) { goto suApa; } goto HwTw9; TNcBE: return $token->user_code; goto aXI7p; IMr6d: $this->db->update($this->tables["\x75\x73\145\162\163"], $update, [$this->identity_column => $identity]); goto QbPoD; ngqNb: suApa: goto G2fH3; DRaSp: $this->trigger_events(["\160\x6f\163\x74\137\x66\x6f\x72\x67\157\164\x74\x65\x6e\x5f\160\141\163\163\167\x6f\x72\144", "\160\x6f\x73\x74\137\x66\157\x72\147\157\164\x74\145\156\137\160\141\x73\163\x77\157\x72\144\x5f\165\156\163\165\x63\x63\145\x73\x73\146\x75\154"]); goto gBTwj; gBTwj: return FALSE; goto K_ROO; e3k7T: $this->trigger_events("\x65\x78\164\x72\x61\x5f\x77\x68\145\162\x65"); goto IMr6d; Un1nc: IMlI_: goto HFBe_; HwTw9: $this->trigger_events(["\160\x6f\x73\x74\x5f\146\157\162\147\157\x74\x74\145\x6e\137\x70\x61\x73\163\x77\x6f\x72\x64", "\160\157\x73\x74\137\x66\157\162\147\157\164\x74\x65\x6e\137\x70\141\x73\x73\x77\x6f\x72\x64\137\165\156\x73\165\x63\143\x65\x73\163\146\x75\x6c"]); goto bpk6R; K_ROO: goto fdrOt; goto Un1nc; aXI7p: fdrOt: goto cyrTR; bpk6R: return FALSE; goto ngqNb; HFBe_: $this->trigger_events(["\160\157\163\164\137\146\x6f\162\x67\157\x74\x74\145\x6e\x5f\x70\141\x73\163\167\157\x72\x64", "\x70\x6f\163\x74\x5f\146\157\x72\147\x6f\164\x74\x65\x6e\137\160\141\163\x73\x77\157\x72\x64\x5f\x73\165\143\x63\x65\163\163\146\165\x6c"]); goto TNcBE; cyrTR: } public function get_user_by_forgotten_password_code($user_code) { goto FTqDQ; Ig7xR: return $user; goto jPK0f; YKqtd: if (!$this->verify_password($token->validator, $user->forgotten_password_code)) { goto ZBJA0; } goto Ig7xR; O3wmq: if (!$user) { goto Ro4M8; } goto YKqtd; bvH_h: Ro4M8: goto wYtVX; t80m0: $user = $this->where("\146\x6f\x72\147\x6f\164\164\145\156\x5f\160\141\163\163\x77\157\162\144\137\x73\x65\154\x65\143\x74\157\162", $token->selector)->users()->row(); goto O3wmq; FTqDQ: $token = $this->_retrieve_selector_validator_couple($user_code); goto t80m0; jPK0f: ZBJA0: goto bvH_h; wYtVX: return FALSE; goto fGk8s; fGk8s: } public function register($identity, $password, $email, $additional_data = array(), $groups = array()) { goto SNKER; Ead84: $this->trigger_events("\160\x6f\163\x74\137\162\x65\x67\x69\x73\164\145\162"); goto Uy4k6; XvCqi: $query = $this->db->get_where($this->tables["\147\x72\157\x75\160\x73"], ["\x6e\141\x6d\145" => $this->config->item("\144\145\146\x61\x75\154\164\x5f\x67\162\157\x75\x70", "\x69\x6f\156\x5f\x61\x75\164\150")], 1)->row(); goto og07x; SNKER: $this->trigger_events("\160\x72\145\x5f\162\145\147\151\x73\x74\x65\x72"); goto Pr64U; CjDYo: Ojabq: goto XvCqi; v94Uz: if (!(isset($default_group->id) && empty($groups))) { goto UjUEK; } goto GBg5P; dNglA: $this->trigger_events("\145\170\164\162\x61\137\163\145\164"); goto eGN37; CHPwY: return FALSE; goto zLUtn; bBj_J: foreach ($groups as $group) { $this->add_to_group($group, $id); nwnxB: } goto A35Au; eZ0Mr: if ($this->identity_check($identity)) { goto iBS9E; } goto A21uq; F3hQO: LxAM0: goto oMsPM; WwDti: iBS9E: goto fwonu; ApwgW: if (empty($groups)) { goto I1dQq; } goto bBj_J; ZOSdC: I1dQq: goto Ead84; y0H1F: return FALSE; goto CjDYo; o9xwm: return FALSE; goto F3hQO; uqQdx: if (!($password === FALSE)) { goto LxAM0; } goto Yvrwh; oMsPM: $data = [$this->identity_column => $identity, "\x75\x73\x65\x72\x6e\141\155\x65" => $identity, "\x70\x61\x73\x73\x77\157\x72\x64" => $password, "\145\x6d\x61\x69\x6c" => $email, "\x69\x70\x5f\x61\144\144\x72\x65\163\163" => $ip_address, "\143\x72\x65\x61\164\145\144\x5f\157\x6e" => time(), "\x61\143\x74\x69\x76\145" => $manual_activation === FALSE ? 1 : 0]; goto Jcx3U; cZFFp: goto Ojabq; goto WwDti; P2FWs: $this->set_error("\x61\x63\x63\x6f\x75\156\164\x5f\x63\x72\x65\x61\164\151\157\156\x5f\x69\x6e\x76\x61\154\151\x64\137\x64\x65\146\141\x75\x6c\164\x5f\x67\162\x6f\165\160"); goto CHPwY; Jcx3U: $user_data = array_merge($this->_filter_data($this->tables["\x75\163\145\162\163"], $additional_data), $data); goto dNglA; MrDHE: UjUEK: goto ApwgW; bf2zk: $default_group = $query; goto W3VdJ; Pr64U: $manual_activation = $this->config->item("\x6d\x61\x6e\165\141\154\137\141\143\164\151\x76\x61\x74\151\x6f\156", "\x69\157\156\137\141\x75\164\x68"); goto eZ0Mr; Uy4k6: return isset($id) ? $id : FALSE; goto snr0n; JVBMB: return FALSE; goto ZXPKD; fzuul: $password = $this->hash_password($password); goto uqQdx; A21uq: if (!(!$this->config->item("\144\145\x66\x61\165\154\164\137\x67\162\x6f\x75\160", "\x69\157\x6e\x5f\x61\x75\x74\x68") && empty($groups))) { goto AlFFs; } goto PFJiZ; GBg5P: $groups[] = $default_group->id; goto MrDHE; PFJiZ: $this->set_error("\x61\143\x63\157\x75\x6e\164\137\143\x72\x65\141\164\x69\x6f\x6e\x5f\x6d\151\163\163\151\156\x67\137\144\x65\146\141\x75\x6c\164\137\x67\x72\x6f\x75\160"); goto JVBMB; ZXPKD: AlFFs: goto cZFFp; Yvrwh: $this->set_error("\141\x63\143\x6f\165\156\164\137\143\x72\x65\141\164\x69\157\x6e\x5f\x75\156\x73\x75\143\143\x65\163\163\146\165\154"); goto o9xwm; og07x: if (!(!isset($query->id) && empty($groups))) { goto KHV0L; } goto P2FWs; fwonu: $this->set_error("\x61\143\x63\157\x75\156\164\137\x63\162\x65\141\x74\151\157\156\137\144\165\x70\x6c\151\143\x61\x74\x65\137\151\144\x65\x6e\164\151\164\x79"); goto y0H1F; Al2wN: $id = $this->db->insert_id($this->tables["\165\x73\145\162\163"] . "\x5f\x69\144\x5f\x73\x65\x71"); goto v94Uz; eGN37: $this->db->insert($this->tables["\165\x73\145\x72\163"], $user_data); goto Al2wN; A35Au: vFlTo: goto ZOSdC; zLUtn: KHV0L: goto bf2zk; W3VdJ: $ip_address = $this->input->ip_address(); goto fzuul; snr0n: } public function login($identity, $password, $remember = FALSE) { goto e_Sxx; S_OrY: return FALSE; goto kjT6V; sm4iX: if (!$this->config->item("\162\x65\155\x65\x6d\x62\145\x72\x5f\x75\163\145\162\163", "\151\157\x6e\137\141\165\x74\x68")) { goto nnvHZ; } goto t6_i1; e_Sxx: $this->trigger_events("\160\162\145\x5f\154\x6f\x67\151\156"); goto EJBqh; lHGy1: $this->set_error("\x6c\x6f\x67\151\156\x5f\164\x69\155\x65\x6f\x75\x74"); goto Cv8Lf; yqU0r: $this->rehash_password_if_needed($user->password, $identity, $password); goto LrbIQ; zwDpd: $this->trigger_events("\x70\157\x73\164\x5f\154\157\147\x69\156\137\165\156\163\x75\143\x63\145\x73\x73\146\165\x6c"); goto q5kK7; Eko1M: $this->clear_forgotten_password_code($identity); goto sm4iX; IQnER: $this->set_error("\154\x6f\x67\151\156\137\165\156\x73\x75\x63\x63\145\163\163\146\x75\154"); goto YQk6F; GfkDC: Kp4Sr: goto cmB7e; lzWrh: Q6l7x: goto hQDYu; t6_i1: if ($remember) { goto Kp4Sr; } goto aS2m_; latBD: return TRUE; goto f93gL; v6r1o: bYnGm: goto jbb04; Mhzs3: $query = $this->db->select($this->identity_column . "\x2c\40\145\155\x61\x69\x6c\54\x20\151\x64\54\40\x70\141\x73\163\167\157\x72\x64\x2c\40\x61\x63\x74\x69\166\x65\x2c\40\x6c\x61\163\x74\137\x6c\x6f\x67\x69\156")->where($this->identity_column, $identity)->limit(1)->order_by("\151\144", "\144\145\163\x63")->get($this->tables["\x75\163\145\162\163"]); goto RpWaE; LrbIQ: $this->session->sess_regenerate(FALSE); goto WbIV8; Cv8Lf: return FALSE; goto lzWrh; q5kK7: $this->set_error("\x6c\x6f\147\x69\156\137\165\156\163\165\x63\143\145\163\163\x66\x75\x6c"); goto S_OrY; cmB7e: $this->remember_user($identity); goto mSc1b; mSc1b: nHH6E: goto GyVDU; dC5s9: $this->clear_login_attempts($identity); goto Eko1M; f7wAX: if (!$this->verify_password($password, $user->password, $identity)) { goto vWzPD; } goto ZA6eR; UNVmQ: $user = $query->row(); goto f7wAX; FvKH0: $this->trigger_events("\x70\x6f\x73\164\x5f\x6c\x6f\147\151\156\x5f\165\156\x73\165\x63\143\x65\163\x73\x66\165\154"); goto lHGy1; hQDYu: if (!($query->num_rows() === 1)) { goto bYnGm; } goto UNVmQ; UiA0Z: iL7g1: goto MGX__; BVYzp: C2zi5: goto Vwcnq; j2vqA: goto nHH6E; goto GfkDC; WbIV8: $this->trigger_events(["\x70\x6f\163\x74\137\x6c\157\147\151\156", "\x70\157\x73\x74\x5f\x6c\157\147\x69\156\137\163\165\x63\143\145\x73\163\x66\165\x6c"]); goto zX9Ju; ryjCh: $this->hash_password($password); goto FvKH0; f93gL: vWzPD: goto v6r1o; SlBOB: $this->increase_login_attempts($identity); goto zwDpd; zX9Ju: $this->set_message("\x6c\157\x67\151\156\137\x73\x75\143\143\x65\x73\163\x66\x75\154"); goto latBD; GyVDU: nnvHZ: goto yqU0r; EJBqh: if (!(empty($identity) || empty($password))) { goto C2zi5; } goto IQnER; RpWaE: if (!$this->is_max_login_attempts_exceeded($identity)) { goto Q6l7x; } goto ryjCh; YQk6F: return FALSE; goto BVYzp; ZA6eR: if (!($user->active == 0)) { goto iL7g1; } goto UD9eC; jbb04: $this->hash_password($password); goto SlBOB; dp_jP: return FALSE; goto UiA0Z; MGX__: $this->set_session($user); goto GkeEP; Vwcnq: $this->trigger_events("\145\170\x74\x72\x61\x5f\167\150\x65\x72\x65"); goto Mhzs3; GkeEP: $this->update_last_login($user->id); goto dC5s9; UD9eC: $this->trigger_events("\x70\x6f\x73\x74\x5f\154\x6f\x67\x69\156\137\x75\156\163\x75\143\143\x65\x73\163\146\165\154"); goto ekbIu; aS2m_: $this->clear_remember_code($identity); goto j2vqA; ekbIu: $this->set_error("\154\x6f\147\151\156\x5f\165\156\x73\165\x63\143\x65\163\163\x66\x75\x6c\137\156\157\164\x5f\x61\x63\x74\x69\166\x65"); goto dp_jP; kjT6V: } public function recheck_session() { goto z0soY; U1J9M: $this->session->set_userdata("\x6c\141\x73\164\x5f\143\x68\145\143\x6b", time()); goto OXRal; kGV41: C_URh: goto U1J9M; eqHt2: $last_login = $this->session->userdata("\x6c\141\x73\164\137\x63\150\145\x63\x6b"); goto grLit; OG9Oy: return (bool) $this->session->userdata("\151\x64\145\156\x74\x69\164\x79"); goto hUht6; kdCe9: goto ueSfE; goto kGV41; a4pmS: fqvlL: goto OG9Oy; H0G8f: $identity = $this->config->item("\x69\144\x65\156\164\151\164\171", "\151\x6f\156\x5f\x61\165\164\150"); goto PEB51; g6fiY: HCUEs: goto a4pmS; PEB51: $this->session->unset_userdata([$identity, "\x69\x64", "\165\x73\x65\162\137\x69\x64"]); goto hkSbP; I0LOR: if (!($recheck !== 0)) { goto fqvlL; } goto eqHt2; grLit: if (!($last_login + $recheck < time())) { goto HCUEs; } goto KVR4y; hkSbP: return FALSE; goto kdCe9; MOaHu: if ($query->num_rows() === 1) { goto C_URh; } goto i6mxz; OXRal: ueSfE: goto g6fiY; i6mxz: $this->trigger_events("\x6c\157\147\x6f\x75\x74"); goto H0G8f; KVR4y: $query = $this->db->select("\151\x64")->where([$this->identity_column => $this->session->userdata("\151\x64\145\x6e\x74\151\x74\171"), "\x61\x63\164\x69\x76\145" => "\61"])->limit(1)->order_by("\x69\x64", "\x64\145\163\143")->get($this->tables["\165\163\145\x72\x73"]); goto MOaHu; z0soY: $recheck = NULL !== $this->config->item("\x72\x65\143\x68\145\x63\x6b\x5f\164\151\155\x65\162", "\151\157\156\x5f\x61\x75\164\150") ? $this->config->item("\162\x65\x63\x68\145\x63\x6b\x5f\x74\x69\x6d\x65\x72", "\151\x6f\156\x5f\x61\x75\x74\150") : 0; goto I0LOR; hUht6: } public function is_max_login_attempts_exceeded($identity, $ip_address = NULL) { goto o5YxL; OkNOc: return $attempts >= $max_attempts; goto QwJ6e; o5YxL: if (!$this->config->item("\164\x72\x61\x63\x6b\x5f\x6c\157\x67\151\156\x5f\x61\x74\164\145\155\x70\164\x73", "\151\157\x6e\137\141\x75\164\150")) { goto POyVF; } goto v0lyA; v0lyA: $max_attempts = $this->config->item("\x6d\141\170\151\x6d\165\155\x5f\154\x6f\147\x69\x6e\x5f\x61\x74\x74\145\155\160\x74\x73", "\x69\x6f\156\x5f\141\165\164\x68"); goto c3ge5; U56L0: return FALSE; goto Jly3v; c3ge5: if (!($max_attempts > 0)) { goto gHAPj; } goto jth_X; PoDqx: POyVF: goto U56L0; QwJ6e: gHAPj: goto PoDqx; jth_X: $attempts = $this->get_attempts_num($identity, $ip_address); goto OkNOc; Jly3v: } public function get_attempts_num($identity, $ip_address = NULL) { goto DwmoM; rDxZ4: if (isset($ip_address)) { goto FG5Qq; } goto JhcIo; pKNXK: return $qres->num_rows(); goto TkoK_; VNLYL: TPZRU: goto sU_wT; I3hzR: $this->db->select("\61", FALSE); goto tWgpo; JhcIo: $ip_address = $this->input->ip_address(); goto DXpKH; qmlJ5: $this->db->where("\151\160\137\141\144\x64\162\x65\x73\x73", $ip_address); goto VNLYL; DwmoM: if (!$this->config->item("\x74\162\x61\x63\x6b\x5f\154\157\x67\151\x6e\137\x61\164\164\x65\155\x70\x74\x73", "\x69\157\x6e\x5f\x61\165\x74\150")) { goto gtAjF; } goto I3hzR; sU_wT: $this->db->where("\x74\x69\155\145\x20\76", time() - $this->config->item("\154\157\143\153\x6f\x75\164\137\164\151\155\145", "\151\x6f\156\x5f\141\x75\x74\x68"), FALSE); goto IBcdE; AZ4sm: return 0; goto Lnz9u; TkoK_: gtAjF: goto AZ4sm; tWgpo: $this->db->where("\154\157\147\151\x6e", $identity); goto NK7Gi; IBcdE: $qres = $this->db->get($this->tables["\154\x6f\x67\151\x6e\x5f\x61\x74\164\145\x6d\160\164\163"]); goto pKNXK; NK7Gi: if (!$this->config->item("\164\x72\141\x63\153\137\154\157\x67\151\x6e\x5f\151\x70\x5f\x61\x64\144\162\145\163\x73", "\151\x6f\156\137\x61\x75\164\150")) { goto TPZRU; } goto rDxZ4; DXpKH: FG5Qq: goto qmlJ5; Lnz9u: } public function get_last_attempt_time($identity, $ip_address = NULL) { goto A_mpE; njV16: hnD9r: goto NDYyO; dP2_p: $ip_address = $this->input->ip_address(); goto ZHmvu; zm0Gh: icZbb: goto t3kz1; ZHmvu: wmVaR: goto awQwA; t3kz1: $this->db->order_by("\x69\x64", "\x64\x65\x73\143"); goto si6mq; z380G: if (!($qres->num_rows() > 0)) { goto hnD9r; } goto o9sIY; nFHxd: if (!$this->config->item("\x74\x72\x61\x63\x6b\137\154\x6f\x67\x69\x6e\137\x69\x70\x5f\141\x64\x64\162\145\163\x73", "\x69\157\x6e\x5f\141\x75\164\x68")) { goto icZbb; } goto PQ5bC; sUbTO: $this->db->select("\164\x69\155\145"); goto AAKZj; awQwA: $this->db->where("\151\160\137\x61\x64\144\162\145\163\163", $ip_address); goto zm0Gh; o9sIY: return $qres->row()->time; goto njV16; PQ5bC: if (isset($ip_address)) { goto wmVaR; } goto dP2_p; si6mq: $qres = $this->db->get($this->tables["\x6c\x6f\147\151\156\x5f\x61\164\164\145\155\160\164\163"], 1); goto z380G; NDYyO: zoQbg: goto HJQWa; HJQWa: return 0; goto Bldno; AAKZj: $this->db->where("\154\157\x67\x69\156", $identity); goto nFHxd; A_mpE: if (!$this->config->item("\164\x72\141\x63\153\x5f\154\x6f\147\151\156\x5f\141\x74\x74\145\x6d\160\164\x73", "\151\x6f\x6e\137\x61\165\164\150")) { goto zoQbg; } goto sUbTO; Bldno: } public function get_last_attempt_ip($identity) { goto h3k1O; h3k1O: if (!($this->config->item("\x74\x72\141\x63\x6b\137\154\157\x67\151\x6e\x5f\141\x74\164\x65\x6d\x70\164\163", "\x69\x6f\x6e\x5f\141\x75\x74\x68") && $this->config->item("\x74\x72\x61\x63\x6b\137\x6c\157\x67\151\156\137\151\x70\137\x61\144\x64\x72\x65\x73\163", "\151\x6f\x6e\x5f\141\165\164\150"))) { goto OAVxV; } goto IWpsu; pd81M: VQWUi: goto PMVIi; zmIk_: $this->db->where("\x6c\x6f\x67\x69\156", $identity); goto jNTf1; jNTf1: $this->db->order_by("\x69\144", "\144\145\163\x63"); goto WZSAO; WZSAO: $qres = $this->db->get($this->tables["\x6c\x6f\147\x69\156\137\x61\164\164\x65\155\x70\x74\163"], 1); goto jnspH; PMVIi: OAVxV: goto kdFVy; kdFVy: return ''; goto y31K7; iPRiv: return $qres->row()->ip_address; goto pd81M; jnspH: if (!($qres->num_rows() > 0)) { goto VQWUi; } goto iPRiv; IWpsu: $this->db->select("\x69\x70\x5f\141\x64\144\162\145\163\x73"); goto zmIk_; y31K7: } public function increase_login_attempts($identity) { goto Ep2bl; HxQbz: $data = ["\151\x70\x5f\141\x64\x64\162\145\x73\x73" => '', "\154\x6f\147\x69\156" => $identity, "\x74\151\x6d\x65" => time()]; goto w0dem; Ep2bl: if (!$this->config->item("\164\162\141\143\x6b\x5f\x6c\x6f\147\151\x6e\x5f\141\x74\x74\145\155\x70\x74\x73", "\151\157\x6e\137\x61\165\164\x68")) { goto Vq77s; } goto HxQbz; PsJ2N: Vq77s: goto uudj7; iv83S: M3AOA: goto FuqXx; w0dem: if (!$this->config->item("\164\162\141\143\153\137\x6c\157\x67\x69\156\x5f\x69\160\137\141\144\x64\162\145\163\x73", "\x69\x6f\x6e\x5f\141\165\x74\150")) { goto M3AOA; } goto Dhyre; FuqXx: return $this->db->insert($this->tables["\x6c\157\x67\x69\156\x5f\x61\164\x74\145\155\160\164\163"], $data); goto PsJ2N; Dhyre: $data["\151\160\137\141\x64\x64\162\x65\163\163"] = $this->input->ip_address(); goto iv83S; uudj7: return FALSE; goto TjokS; TjokS: } public function clear_login_attempts($identity, $old_attempts_expire_period = 86400, $ip_address = NULL) { goto KQic6; rDH1e: return FALSE; goto PTh1E; hBhql: tqd26: goto XmjuX; BCf0y: $this->db->where("\x6c\157\147\151\156", $identity); goto dQ1eR; VfSlH: $ip_address = $this->input->ip_address(); goto hBhql; ElX04: kWfNY: goto rDH1e; D6C_m: return $this->db->delete($this->tables["\154\x6f\147\151\156\137\x61\164\164\x65\x6d\160\x74\x73"]); goto ElX04; JwA2a: $old_attempts_expire_period = max($old_attempts_expire_period, $this->config->item("\154\157\x63\x6b\157\x75\164\137\164\x69\155\145", "\151\157\x6e\137\x61\165\164\x68")); goto BCf0y; eZ3CV: if (isset($ip_address)) { goto tqd26; } goto VfSlH; UqAUr: i1oX5: goto vse3W; dQ1eR: if (!$this->config->item("\x74\x72\x61\143\x6b\x5f\x6c\157\x67\151\x6e\x5f\151\160\137\x61\x64\144\162\145\163\x73", "\151\x6f\156\x5f\x61\165\164\x68")) { goto i1oX5; } goto eZ3CV; XmjuX: $this->db->where("\x69\x70\x5f\x61\x64\144\162\x65\x73\x73", $ip_address); goto UqAUr; vse3W: $this->db->or_where("\x74\x69\x6d\145\40\x3c", time() - $old_attempts_expire_period, FALSE); goto D6C_m; KQic6: if (!$this->config->item("\164\x72\141\143\153\137\154\157\x67\151\x6e\137\x61\x74\x74\145\155\x70\x74\x73", "\x69\157\x6e\x5f\x61\165\x74\x68")) { goto kWfNY; } goto JwA2a; PTh1E: } public function limit($limit) { goto X9QVi; Qu7Zk: $this->_ion_limit = $limit; goto mfyuB; mfyuB: return $this; goto YOTT3; X9QVi: $this->trigger_events("\154\x69\155\151\x74"); goto Qu7Zk; YOTT3: } public function offset($offset) { goto IL0zk; IL0zk: $this->trigger_events("\157\146\x66\x73\x65\x74"); goto r38Zm; r38Zm: $this->_ion_offset = $offset; goto TOqZK; TOqZK: return $this; goto wne9b; wne9b: } public function where($where, $value = NULL) { goto bF2wL; bF2wL: $this->trigger_events("\167\150\145\x72\x65"); goto TMqTk; oPfRv: $where = [$where => $value]; goto ZQGS9; ZQGS9: CBSiF: goto j3dSc; TMqTk: if (is_array($where)) { goto CBSiF; } goto oPfRv; j3dSc: array_push($this->_ion_where, $where); goto PKlyI; PKlyI: return $this; goto fpbYK; fpbYK: } public function like($like, $value = NULL, $position = "\x62\x6f\x74\150") { goto YQKhs; QzbmE: array_push($this->_ion_like, ["\x6c\x69\x6b\x65" => $like, "\166\141\154\165\x65" => $value, "\160\x6f\x73\151\164\x69\x6f\x6e" => $position]); goto vPqD_; YQKhs: $this->trigger_events("\154\151\x6b\x65"); goto QzbmE; vPqD_: return $this; goto bb_x1; bb_x1: } public function select($select) { goto sLTIy; dV4LS: $this->_ion_select[] = $select; goto u_hnk; sLTIy: $this->trigger_events("\163\x65\x6c\x65\x63\x74"); goto dV4LS; u_hnk: return $this; goto cnVKZ; cnVKZ: } public function order_by($by, $order = "\x64\145\x73\x63") { goto IQlXz; cOTSB: $this->_ion_order = $order; goto Zi4VW; KHHgn: $this->_ion_order_by = $by; goto cOTSB; IQlXz: $this->trigger_events("\x6f\162\144\145\x72\137\x62\x79"); goto KHHgn; Zi4VW: return $this; goto ZwsVZ; ZwsVZ: } public function row() { goto agGPy; sHhgx: return $row; goto Ab0YK; agGPy: $this->trigger_events("\162\157\167"); goto wyxuU; wyxuU: $row = $this->response->row(); goto sHhgx; Ab0YK: } public function row_array() { goto KNELn; KNELn: $this->trigger_events(["\162\157\x77", "\162\x6f\x77\x5f\x61\162\162\x61\171"]); goto hcxur; mUrP7: return $row; goto UcUSE; hcxur: $row = $this->response->row_array(); goto mUrP7; UcUSE: } public function result() { goto O5XNg; tQ0Hy: return $result; goto yVeH2; O5XNg: $this->trigger_events("\x72\x65\163\165\154\164"); goto esRjG; esRjG: $result = $this->response->result(); goto tQ0Hy; yVeH2: } public function result_array() { goto kKLMH; kKLMH: $this->trigger_events(["\x72\x65\163\165\154\x74", "\162\x65\x73\165\154\164\x5f\x61\x72\162\x61\x79"]); goto aOTW_; aOTW_: $result = $this->response->result_array(); goto US4kp; US4kp: return $result; goto BSuOH; BSuOH: } public function num_rows() { goto y5dRZ; pptQK: $result = $this->response->num_rows(); goto XKlCf; XKlCf: return $result; goto Bs3Sm; y5dRZ: $this->trigger_events(["\156\165\x6d\137\162\x6f\167\x73"]); goto pptQK; Bs3Sm: } public function users($groups = NULL) { goto n_5Y1; PguZc: if (!isset($groups)) { goto scmfC; } goto syeMv; phT12: Y5UnE: goto lqRsy; eDnon: uDlLy: goto RpxC3; KC8LY: $this->db->limit($this->_ion_limit); goto WQHlX; n_5Y1: $this->trigger_events("\x75\163\x65\x72\x73"); goto j_XC6; Wo4eE: if (!isset($this->_ion_limit)) { goto Z6XeQ; } goto KC8LY; RpxC3: if (!(isset($this->_ion_like) && !empty($this->_ion_like))) { goto FHlle; } goto d0A2O; zhb86: foreach ($this->_ion_where as $where) { $this->db->where($where); NPG2s: } goto s0Z0b; syeMv: if (is_array($groups)) { goto Y5UnE; } goto IG5Uq; qOR3u: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto tYTYZ; } goto Wo4eE; hBZ4G: foreach ($groups as $group) { goto RjZt2; YTd0v: kTuYi: goto STlfr; Upy41: goto kTuYi; goto O6E4G; STlfr: XhVE3: goto pvCmf; O6E4G: JL9Zx: goto ZeJ7Z; ZeJ7Z: $group_ids[] = $group; goto YTd0v; RjZt2: if (is_numeric($group)) { goto JL9Zx; } goto iNXpp; iNXpp: $group_names[] = $group; goto Upy41; pvCmf: } goto DDIO7; AkeLj: if (empty($group_names)) { goto ZfBd6; } goto TdRED; mRi1u: $this->_ion_order = NULL; goto X5Y9v; ECKkM: $this->_ion_offset = NULL; goto Gmwo2; CEvcK: A3gSr: goto ZW5_v; j_XC6: if (isset($this->_ion_select) && !empty($this->_ion_select)) { goto yxLhf; } goto gpho9; Vt0Wy: mDVBE: goto ICZx6; ZW5_v: $this->response = $this->db->get($this->tables["\x75\163\145\x72\x73"]); goto RqTds; SFk01: NSPUE: goto PguZc; W7dHF: iv7gJ: goto QY7V2; IG5Uq: $groups = [$groups]; goto phT12; zlWVj: $this->db->join($this->tables["\165\x73\145\162\x73\137\147\162\x6f\x75\160\163"], $this->tables["\165\163\x65\x72\163\137\147\162\157\x75\x70\x73"] . "\56" . $this->join["\165\163\145\162\163"] . "\75" . $this->tables["\165\x73\145\x72\163"] . "\56\151\x64", "\x69\x6e\x6e\145\162"); goto qWNGg; BL0M2: $this->trigger_events("\145\170\164\162\141\x5f\167\150\145\162\x65"); goto nkXNv; Gmwo2: hdYMk: goto LPiTJ; R3f6z: if (empty($group_ids)) { goto mDVBE; } goto aryim; nkXNv: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto uDlLy; } goto zhb86; LPiTJ: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto A3gSr; } goto qCt1p; s0Z0b: YRrfA: goto vr728; FZz0N: goto hdYMk; goto jecFR; ICZx6: scmfC: goto BL0M2; lqRsy: if (!(isset($groups) && !empty($groups))) { goto y64pC; } goto Sb_OV; gUWsQ: $this->db->where_in($this->tables["\147\x72\157\x75\x70\x73"] . "\56\x6e\141\155\x65", $group_names); goto YWr3P; QY7V2: $this->_ion_select = []; goto SFk01; Sb_OV: $this->db->distinct(); goto zlWVj; GWbDF: goto NSPUE; goto UZN4f; qCt1p: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto mRi1u; YWr3P: ZfBd6: goto R3f6z; Lb0VX: FHlle: goto qOR3u; vEwwn: nj2Z2: goto beW8L; Lbywf: Z6XeQ: goto FZz0N; RqTds: return $this; goto FRyKL; t2AAB: $group_ids = []; goto ggDC9; aryim: $this->db->{$or_where_in}($this->tables["\x75\x73\145\162\163\x5f\x67\x72\157\x75\160\163"] . "\x2e" . $this->join["\147\x72\157\165\x70\x73"], $group_ids); goto Vt0Wy; Ff1NM: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto BkGvE; DDIO7: hEGOe: goto wcH3o; d0A2O: foreach ($this->_ion_like as $like) { $this->db->or_like($like["\x6c\151\x6b\145"], $like["\x76\141\x6c\165\145"], $like["\160\x6f\163\151\164\151\x6f\156"]); dvxoL: } goto vEwwn; WQHlX: $this->_ion_limit = NULL; goto Lbywf; TdRED: $this->db->join($this->tables["\147\162\x6f\165\x70\163"], $this->tables["\x75\163\x65\162\163\x5f\147\162\x6f\165\160\x73"] . "\56" . $this->join["\147\162\157\x75\160\x73"] . "\x20\75\x20" . $this->tables["\x67\162\x6f\x75\160\163"] . "\56\x69\144", "\x69\x6e\156\145\x72"); goto gUWsQ; vr728: $this->_ion_where = []; goto eDnon; qWNGg: y64pC: goto t2AAB; OfSZq: foreach ($this->_ion_select as $select) { $this->db->select($select); DI2Cr: } goto W7dHF; ggDC9: $group_names = []; goto hBZ4G; X5Y9v: $this->_ion_order_by = NULL; goto CEvcK; beW8L: $this->_ion_like = []; goto Lb0VX; UZN4f: yxLhf: goto OfSZq; jecFR: tYTYZ: goto Ff1NM; gpho9: $this->db->select([$this->tables["\165\163\145\x72\x73"] . "\x2e\x2a", $this->tables["\165\x73\145\x72\x73"] . "\56\151\144\40\x61\163\x20\151\x64", $this->tables["\165\163\x65\162\x73"] . "\x2e\x69\x64\40\x61\x73\40\x75\163\x65\x72\x5f\x69\144"]); goto GWbDF; wcH3o: $or_where_in = !empty($group_ids) && !empty($group_names) ? "\157\x72\x5f\x77\150\145\162\x65\x5f\x69\156" : "\167\x68\x65\162\x65\137\151\x6e"; goto AkeLj; BkGvE: $this->_ion_limit = NULL; goto ECKkM; FRyKL: } public function user($id = NULL) { goto JvWvy; vATZp: return $this; goto mWf1O; KjLUp: $this->order_by($this->tables["\x75\x73\x65\162\x73"] . "\56\151\144", "\144\x65\x73\143"); goto CBxcV; nqn03: $id = isset($id) ? $id : $this->session->userdata("\165\x73\x65\162\x5f\151\x64"); goto a1Znu; CBxcV: $this->where($this->tables["\165\163\145\x72\x73"] . "\56\x69\144", $id); goto jm0LE; JvWvy: $this->trigger_events("\165\163\x65\162"); goto nqn03; jm0LE: $this->users(); goto vATZp; a1Znu: $this->limit(1); goto KjLUp; mWf1O: } public function get_users_groups($id = FALSE) { goto SNuh8; OqvcM: return $this->db->select($this->tables["\x75\x73\x65\x72\x73\137\147\x72\x6f\165\160\x73"] . "\x2e" . $this->join["\x67\x72\x6f\165\x70\163"] . "\x20\x61\163\x20\151\144\x2c\x20" . $this->tables["\x67\162\x6f\165\160\163"] . "\56\x6e\141\x6d\x65\54\40" . $this->tables["\147\162\x6f\x75\160\x73"] . "\x2e\144\145\163\143\x72\151\x70\164\x69\157\x6e")->where($this->tables["\165\x73\x65\x72\163\x5f\147\x72\157\x75\160\163"] . "\56" . $this->join["\165\163\x65\162\163"], $id)->join($this->tables["\147\162\x6f\165\x70\163"], $this->tables["\165\163\145\162\x73\137\147\x72\x6f\x75\x70\x73"] . "\x2e" . $this->join["\147\x72\157\165\x70\x73"] . "\75" . $this->tables["\x67\162\157\x75\160\163"] . "\x2e\x69\x64")->get($this->tables["\x75\163\145\x72\163\137\147\162\x6f\x75\160\x73"]); goto g2m22; Qa23c: $id || ($id = $this->session->userdata("\165\x73\x65\162\137\x69\144")); goto OqvcM; SNuh8: $this->trigger_events("\147\x65\164\x5f\165\x73\x65\162\x73\137\147\162\157\x75\x70"); goto Qa23c; g2m22: } public function in_group($check_group, $id = FALSE, $check_all = FALSE) { goto oKkga; hXqhx: $check_group = [$check_group]; goto gZ8Gb; GeYf5: if (is_array($check_group)) { goto vBjwk; } goto hXqhx; hLMuW: $groups_array = $this->_cache_user_in_group[$id]; goto LLA7b; qsp13: EApkr: goto nkkb0; jSOhz: $users_groups = $this->get_users_groups($id)->result(); goto AYOIc; V2zyt: cRzTY: goto xTg0I; nkkb0: $this->_cache_user_in_group[$id] = $groups_array; goto C3Yn9; qfHFL: OCo0q: goto hLMuW; ww2Hj: if (isset($this->_cache_user_in_group[$id])) { goto OCo0q; } goto jSOhz; AYOIc: $groups_array = []; goto DWYCX; oKkga: $this->trigger_events("\151\156\x5f\147\162\157\x75\160"); goto o26wc; o26wc: $id || ($id = $this->session->userdata("\x75\x73\145\162\x5f\151\x64")); goto GeYf5; xTg0I: return $check_all; goto hRMEF; DWYCX: foreach ($users_groups as $group) { $groups_array[$group->id] = $group->name; Z9H1l: } goto qsp13; gZ8Gb: vBjwk: goto ww2Hj; C3Yn9: goto GuDJk; goto qfHFL; fWhqT: foreach ($check_group as $key => $value) { goto SRu8Q; zAN4w: return !$check_all; goto saaA6; SRu8Q: $groups = is_numeric($value) ? array_keys($groups_array) : $groups_array; goto HYhvh; J9MTy: fL5Lw: goto Ar0kH; saaA6: jdA2P: goto J9MTy; HYhvh: if (!(in_array($value, $groups) xor $check_all)) { goto jdA2P; } goto zAN4w; Ar0kH: } goto V2zyt; LLA7b: GuDJk: goto fWhqT; hRMEF: } public function add_to_group($group_ids, $user_id = FALSE) { goto HhrDC; Ib5qt: if (is_array($group_ids)) { goto KrQLY; } goto ZsbGl; tcENN: KrQLY: goto kR3V7; VSo2N: AKJ9t: goto E3ek9; HhrDC: $this->trigger_events("\x61\144\144\x5f\x74\x6f\x5f\147\162\x6f\x75\160"); goto Gwo6r; Gwo6r: $user_id || ($user_id = $this->session->userdata("\x75\163\x65\162\137\151\x64")); goto Ib5qt; YJcnL: foreach ($group_ids as $group_id) { goto BduN5; LgwHa: goto hhsXS; goto otbfQ; c9NrR: QWZkl: goto cNqEq; BduN5: if (!$this->db->insert($this->tables["\165\163\145\162\163\x5f\147\162\x6f\165\160\x73"], [$this->join["\x67\x72\157\165\160\163"] => (float) $group_id, $this->join["\x75\163\x65\162\x73"] => (float) $user_id])) { goto QWZkl; } goto pdEpB; JQB01: $group_name = $group[0]->name; goto EafLt; otbfQ: WlFrU: goto quTZC; EafLt: $this->_cache_groups[$group_id] = $group_name; goto LgwHa; quTZC: $group_name = $this->_cache_groups[$group_id]; goto gZevt; gZevt: hhsXS: goto olKcI; b7QZA: $return++; goto c9NrR; pdEpB: if (isset($this->_cache_groups[$group_id])) { goto WlFrU; } goto fXI_G; fXI_G: $group = $this->group($group_id)->result(); goto JQB01; olKcI: $this->_cache_user_in_group[$user_id][$group_id] = $group_name; goto b7QZA; cNqEq: LyvfC: goto GA80f; GA80f: } goto VSo2N; kR3V7: $return = 0; goto YJcnL; ZsbGl: $group_ids = [$group_ids]; goto tcENN; E3ek9: return $return; goto DWOmT; DWOmT: } public function remove_from_group($group_ids = FALSE, $user_id = FALSE) { goto aGg_W; HSzcZ: $group_ids = [$group_ids]; goto Ldz24; vgjFW: Z1kJ6: goto J3VKt; c56Ob: if (!empty($user_id)) { goto P8qH8; } goto bnvVj; e6KPp: goto W1QhC; goto G73kI; oF4r4: $this->_cache_user_in_group[$user_id] = []; goto eTi3W; Ldz24: nWBmz: goto emph5; emph5: foreach ($group_ids as $group_id) { goto Sg2Fb; omdE_: Sy9tr: goto oafwR; Sg2Fb: $this->db->delete($this->tables["\x75\x73\x65\162\163\137\147\162\157\x75\160\x73"], [$this->join["\x67\x72\157\x75\160\x73"] => (float) $group_id, $this->join["\165\163\145\x72\163"] => (float) $user_id]); goto lTAsN; lTAsN: if (!(isset($this->_cache_user_in_group[$user_id]) && isset($this->_cache_user_in_group[$user_id][$group_id]))) { goto Sy9tr; } goto AszWP; oafwR: QG8v6: goto f8ErU; AszWP: unset($this->_cache_user_in_group[$user_id][$group_id]); goto omdE_; f8ErU: } goto vgjFW; bnvVj: return FALSE; goto KBD0Q; eTi3W: fGArX: goto e6KPp; aGg_W: $this->trigger_events("\x72\x65\155\157\x76\x65\137\146\x72\x6f\155\x5f\x67\x72\157\165\160"); goto c56Ob; AH2Mt: W1QhC: goto KbY2d; G73kI: YCwYA: goto VZu0V; KBD0Q: P8qH8: goto y4wry; VZu0V: if (is_array($group_ids)) { goto nWBmz; } goto HSzcZ; KbY2d: return $return; goto ybkmi; HM53B: if (!($return = $this->db->delete($this->tables["\165\163\145\162\x73\x5f\x67\x72\157\165\x70\x73"], [$this->join["\165\x73\x65\162\163"] => (float) $user_id]))) { goto fGArX; } goto oF4r4; y4wry: if (!empty($group_ids)) { goto YCwYA; } goto HM53B; J3VKt: $return = TRUE; goto AH2Mt; ybkmi: } public function groups() { goto fBB3x; qUbPx: $this->response = $this->db->get($this->tables["\147\162\157\165\x70\163"]); goto tF2mU; bpVBV: NITLC: goto qUbPx; TsWYI: $this->_ion_limit = NULL; goto KxONr; NrG13: $this->_ion_limit = NULL; goto dCMVY; DXePk: $this->db->limit($this->_ion_limit); goto TsWYI; KxONr: XGiHW: goto z3dq5; nnGOO: $this->db->order_by($this->_ion_order_by, $this->_ion_order); goto bpVBV; HJpEw: mqGTc: goto N8Ruj; PcbXq: U22As: goto d5PCa; q5jgz: if (!(isset($this->_ion_order_by) && isset($this->_ion_order))) { goto NITLC; } goto nnGOO; N8Ruj: if (isset($this->_ion_limit) && isset($this->_ion_offset)) { goto rdyLO; } goto EBuKY; EBuKY: if (!isset($this->_ion_limit)) { goto XGiHW; } goto DXePk; bzUBL: LSI0c: goto q5jgz; ukjV_: if (!(isset($this->_ion_where) && !empty($this->_ion_where))) { goto mqGTc; } goto TqMmm; fBB3x: $this->trigger_events("\x67\x72\157\x75\160\163"); goto ukjV_; z3dq5: goto LSI0c; goto vs8vh; d5PCa: $this->_ion_where = []; goto HJpEw; dCMVY: $this->_ion_offset = NULL; goto bzUBL; tCn5m: $this->db->limit($this->_ion_limit, $this->_ion_offset); goto NrG13; TqMmm: foreach ($this->_ion_where as $where) { $this->db->where($where); ipsKv: } goto PcbXq; vs8vh: rdyLO: goto tCn5m; tF2mU: return $this; goto J_MYi; J_MYi: } public function group($id = NULL) { goto yaCH0; yaCH0: $this->trigger_events("\x67\x72\157\x75\x70"); goto mfmBO; WIr85: BzreD: goto PUw5M; PUw5M: $this->limit(1); goto jHXYw; kLpSw: $this->where($this->tables["\x67\162\x6f\165\x70\x73"] . "\56\151\x64", $id); goto WIr85; mfmBO: if (!isset($id)) { goto BzreD; } goto kLpSw; jHXYw: $this->order_by("\151\x64", "\144\x65\163\x63"); goto vTciN; vTciN: return $this->groups(); goto OqQpQ; OqQpQ: } public function update($id, array $data) { goto EpYKr; RrGQp: hp23E: goto Gz0eE; hZ69g: $this->set_error("\165\x70\144\141\x74\x65\x5f\165\156\x73\165\143\x63\145\x73\163\146\x75\154"); goto yDZuY; f8CIK: if (!(array_key_exists($this->identity_column, $data) && $this->identity_check($data[$this->identity_column]) && $user->{$this->identity_column} !== $data[$this->identity_column])) { goto NHJgV; } goto q7Nw3; gs928: $this->set_error("\165\160\144\141\x74\x65\x5f\165\156\163\x75\x63\x63\145\163\163\x66\165\154"); goto jOIMc; g9Ojq: $this->db->trans_rollback(); goto yo09o; PDbPP: $data["\x70\141\163\x73\167\157\162\x64"] = $this->hash_password($data["\160\141\163\x73\x77\x6f\162\144"], $user->{$this->identity_column}); goto NYdfD; GOGIm: $this->set_error("\165\160\x64\x61\x74\x65\x5f\x75\156\x73\x75\143\143\145\163\x73\146\165\154"); goto G2a8K; EJXlC: $this->trigger_events("\x65\x78\x74\x72\x61\137\x77\150\x65\x72\145"); goto U0abj; N66VF: $this->set_message("\x75\160\x64\141\164\145\137\x73\165\x63\x63\145\x73\x73\x66\x75\154"); goto k28Y8; jOIMc: return FALSE; goto BOpUW; R_SJF: $this->trigger_events(["\160\x6f\163\164\x5f\x75\160\x64\x61\164\x65\x5f\x75\163\x65\162", "\160\x6f\163\164\x5f\x75\160\144\x61\x74\x65\x5f\x75\x73\145\162\x5f\163\x75\x63\x63\145\163\x73\146\165\154"]); goto N66VF; JPfMr: $this->trigger_events(["\x70\x6f\x73\x74\x5f\x75\x70\144\141\164\x65\x5f\165\x73\145\x72", "\160\157\163\164\x5f\x75\160\x64\141\164\x65\137\x75\163\145\162\137\x75\x6e\x73\165\x63\143\x65\x73\x73\x66\165\154"]); goto hZ69g; MfLk8: s3VEb: goto EJXlC; uC8OD: unset($data["\x70\141\x73\163\167\x6f\x72\144"]); goto dBi3u; lgsQB: $this->trigger_events(["\160\x6f\x73\164\137\165\160\144\141\x74\x65\137\x75\x73\145\162", "\160\x6f\163\164\137\x75\x70\x64\141\x74\145\137\x75\163\x65\162\137\x75\156\x73\165\143\143\x65\x73\163\x66\x75\x6c"]); goto gs928; yo09o: $this->trigger_events(["\x70\x6f\163\x74\x5f\x75\160\144\141\x74\x65\x5f\x75\x73\145\162", "\x70\x6f\x73\x74\137\x75\160\x64\x61\x74\x65\137\165\x73\x65\162\x5f\x75\156\163\x75\143\143\145\x73\x73\146\x75\x6c"]); goto GOGIm; g0_Ky: if (!empty($data["\160\x61\x73\163\x77\157\x72\x64"])) { goto kuTvM; } goto uC8OD; U0abj: $this->db->update($this->tables["\165\x73\145\x72\x73"], $data, ["\151\x64" => $user->id]); goto u19uJ; hk2t2: $data = $this->_filter_data($this->tables["\165\163\145\x72\163"], $data); goto vQeSW; md32N: if (!array_key_exists("\x70\x61\x73\163\167\x6f\162\x64", $data)) { goto OxZWR; } goto g0_Ky; q7Nw3: $this->db->trans_rollback(); goto xo13X; vQeSW: if (!(array_key_exists($this->identity_column, $data) || array_key_exists("\160\141\x73\x73\167\x6f\x72\144", $data) || array_key_exists("\145\x6d\x61\x69\x6c", $data))) { goto s3VEb; } goto md32N; BOpUW: Cyj0w: goto EW0zF; dBi3u: goto OYgjF; goto DVgA5; Vu9fG: OxZWR: goto MfLk8; OZ4jn: $this->db->trans_begin(); goto f8CIK; BEOKC: $this->db->trans_rollback(); goto lgsQB; DVgA5: kuTvM: goto PDbPP; holOp: NHJgV: goto hk2t2; u19uJ: if (!($this->db->trans_status() === FALSE)) { goto Cyj0w; } goto BEOKC; EW0zF: $this->db->trans_commit(); goto R_SJF; G2a8K: return FALSE; goto RrGQp; k28Y8: return TRUE; goto n53pw; QUfQ2: $user = $this->user($id)->row(); goto OZ4jn; EpYKr: $this->trigger_events("\160\162\145\x5f\165\160\144\141\x74\x65\137\x75\163\145\162"); goto QUfQ2; xo13X: $this->set_error("\x61\x63\x63\x6f\165\156\x74\x5f\x63\x72\x65\141\164\x69\x6f\156\x5f\144\165\160\154\151\x63\141\x74\x65\x5f\x69\144\x65\156\x74\x69\164\x79"); goto JPfMr; yDZuY: return FALSE; goto holOp; NYdfD: if (!($data["\x70\141\163\163\x77\157\x72\144"] === FALSE)) { goto hp23E; } goto g9Ojq; Gz0eE: OYgjF: goto Vu9fG; n53pw: } public function delete_user($id) { goto W_8j2; VkWll: $this->trigger_events(["\160\x6f\x73\x74\137\x64\145\154\x65\164\x65\x5f\165\163\145\162", "\160\157\x73\164\x5f\x64\145\x6c\x65\x74\145\x5f\165\x73\x65\162\137\165\156\x73\x75\x63\x63\x65\x73\163\146\x75\154"]); goto IJYcw; UZeJx: return FALSE; goto DOEug; nyFr3: $this->trigger_events(["\x70\157\x73\164\x5f\x64\145\x6c\145\x74\x65\x5f\x75\163\145\x72", "\160\157\x73\x74\137\144\145\154\x65\164\145\137\x75\163\145\162\x5f\163\x75\143\x63\145\x73\x73\146\x75\154"]); goto zE6Vn; wjOoT: return TRUE; goto o1Lzr; zE6Vn: $this->set_message("\x64\145\154\x65\x74\145\x5f\163\165\143\143\145\x73\x73\x66\165\x6c"); goto wjOoT; W_8j2: $this->trigger_events("\x70\162\145\x5f\144\145\154\145\164\x65\137\x75\x73\145\x72"); goto gG3JE; mUlSN: $this->remove_from_group(NULL, $id); goto K2Uqp; DOEug: oHGb7: goto NEU3Q; NEU3Q: $this->db->trans_commit(); goto nyFr3; gG3JE: $this->db->trans_begin(); goto mUlSN; K2Uqp: $this->db->delete($this->tables["\x75\x73\145\x72\x73"], ["\151\144" => $id]); goto EGC39; EGC39: if (!($this->db->trans_status() === FALSE)) { goto oHGb7; } goto W_XiH; IJYcw: $this->set_error("\144\145\x6c\x65\164\145\137\165\156\x73\x75\143\143\x65\x73\163\x66\165\154"); goto UZeJx; W_XiH: $this->db->trans_rollback(); goto VkWll; o1Lzr: } public function update_last_login($id) { goto RIqMd; HsHjG: $this->db->update($this->tables["\x75\x73\x65\x72\163"], ["\154\141\163\164\x5f\x6c\x6f\147\x69\156" => time()], ["\151\144" => $id]); goto vx_t2; wc6vJ: $this->load->helper("\x64\x61\164\145"); goto Fd2dA; vx_t2: return $this->db->affected_rows() == 1; goto m6s02; Fd2dA: $this->trigger_events("\x65\170\164\162\x61\137\167\150\145\162\145"); goto HsHjG; RIqMd: $this->trigger_events("\x75\160\x64\141\x74\145\137\154\141\x73\164\x5f\x6c\x6f\147\x69\156"); goto wc6vJ; m6s02: } public function set_lang($lang = "\x65\x6e") { goto j1mc3; MeCpq: set_cookie(["\156\x61\155\x65" => "\154\141\156\x67\137\143\157\x64\x65", "\166\x61\x6c\165\145" => $lang, "\x65\x78\160\151\162\x65" => $expire]); goto Vty9T; jMkPh: $expire = self::MAX_COOKIE_LIFETIME; goto BrdEy; g4vzS: goto zzu95; goto CB_a1; j1mc3: $this->trigger_events("\x73\145\164\137\x6c\141\x6e\x67"); goto MhDDQ; MhDDQ: if ($this->config->item("\165\163\145\162\137\x65\170\x70\151\x72\x65", "\151\x6f\x6e\x5f\141\x75\164\150") === 0) { goto TABCA; } goto v4Uxc; BrdEy: zzu95: goto MeCpq; CB_a1: TABCA: goto jMkPh; Vty9T: return TRUE; goto TJxHr; v4Uxc: $expire = $this->config->item("\x75\163\145\x72\x5f\x65\x78\x70\151\162\x65", "\151\157\156\137\141\x75\164\x68"); goto g4vzS; TJxHr: } public function set_session($user) { goto yliNY; XMQXW: $this->session->set_userdata($session_data); goto KRyvV; yliNY: $this->trigger_events("\160\162\x65\x5f\163\x65\x74\x5f\x73\x65\163\x73\151\x6f\156"); goto xEWpX; SSebI: return TRUE; goto h2CU2; KRyvV: $this->trigger_events("\160\157\x73\x74\x5f\x73\x65\164\x5f\163\145\x73\163\151\157\156"); goto SSebI; xEWpX: $session_data = ["\151\x64\145\x6e\164\151\x74\x79" => $user->{$this->identity_column}, $this->identity_column => $user->{$this->identity_column}, "\145\x6d\141\151\x6c" => $user->email, "\x75\x73\145\x72\x5f\151\144" => $user->id, "\157\154\144\x5f\154\141\x73\164\x5f\154\157\147\151\156" => $user->last_login, "\154\x61\163\x74\137\143\x68\145\x63\x6b" => time()]; goto XMQXW; h2CU2: } public function remember_user($identity) { goto GoG43; ja2IS: if ($identity) { goto eSOzX; } goto ktW1b; StMoY: $expire = $this->config->item("\x75\x73\x65\162\x5f\x65\x78\x70\x69\162\x65", "\x69\x6f\156\137\141\165\x74\150"); goto zJpF2; Gj7k_: set_cookie(["\x6e\x61\155\145" => $this->config->item("\162\145\155\x65\x6d\142\x65\162\x5f\x63\157\x6f\x6b\151\x65\137\x6e\x61\155\145", "\151\157\x6e\137\141\165\x74\150"), "\x76\141\x6c\165\x65" => $token->user_code, "\145\x78\x70\151\x72\145" => $expire]); goto zQtQB; zQtQB: $this->trigger_events(["\x70\157\x73\164\137\162\145\155\145\x6d\142\145\x72\137\165\x73\x65\x72", "\x72\145\155\x65\155\142\x65\x72\x5f\165\x73\145\162\137\163\x75\143\x63\x65\163\163\x66\x75\x6c"]); goto GdNfr; t7DCi: return FALSE; goto ieB2_; zJpF2: goto iVFyc; goto ptW65; zo1OK: $this->trigger_events(["\160\157\163\x74\137\x72\145\155\145\x6d\x62\x65\x72\x5f\165\x73\x65\x72", "\x72\145\x6d\145\x6d\142\x65\162\137\165\x73\145\x72\x5f\x75\156\163\165\143\x63\145\x73\163\x66\165\154"]); goto t7DCi; GoG43: $this->trigger_events("\160\162\145\x5f\x72\x65\x6d\x65\155\142\145\162\137\165\x73\145\x72"); goto ja2IS; uAH8H: $this->db->update($this->tables["\165\163\145\162\x73"], ["\162\x65\155\x65\x6d\x62\145\162\137\163\145\x6c\145\x63\164\x6f\x72" => $token->selector, "\x72\x65\x6d\x65\155\x62\145\x72\x5f\x63\x6f\x64\145" => $token->validator_hashed], [$this->identity_column => $identity]); goto zQ23q; eqGcv: iVFyc: goto Gj7k_; ptW65: ynFrA: goto OqGAs; zQ23q: if (!($this->db->affected_rows() > -1)) { goto K9k6W; } goto NZMWo; aImN2: cm6cm: goto zo1OK; ktW1b: return FALSE; goto vhkdL; O38fO: K9k6W: goto aImN2; vhkdL: eSOzX: goto OC6NY; NZMWo: if ($this->config->item("\165\x73\x65\x72\137\x65\x78\160\151\x72\x65", "\151\157\x6e\x5f\141\165\x74\x68") === 0) { goto ynFrA; } goto StMoY; OC6NY: $token = $this->_generate_selector_validator_couple(); goto KOZkt; GdNfr: return TRUE; goto O38fO; KOZkt: if (!$token->validator_hashed) { goto cm6cm; } goto uAH8H; OqGAs: $expire = self::MAX_COOKIE_LIFETIME; goto eqGcv; ieB2_: } public function login_remembered_user() { goto IAy25; Vy8hf: $query = $this->db->select($this->identity_column . "\x2c\40\151\144\x2c\x20\x65\x6d\141\151\x6c\54\40\x72\145\155\x65\155\x62\x65\x72\137\143\157\x64\x65\54\40\x6c\x61\x73\x74\137\154\157\x67\151\156")->where("\162\x65\155\x65\x6d\142\x65\x72\137\x73\145\x6c\145\143\x74\157\x72", $token->selector)->where("\141\x63\164\x69\166\x65", 1)->limit(1)->get($this->tables["\165\x73\x65\x72\163"]); goto Sc2gX; Nj3RQ: $token = $this->_retrieve_selector_validator_couple($remember_cookie); goto r0nHv; HrVaX: $this->trigger_events(["\x70\x6f\163\164\x5f\x6c\x6f\x67\151\156\x5f\x72\145\x6d\x65\155\x62\x65\x72\145\144\137\165\163\145\162", "\160\157\x73\x74\137\154\157\x67\x69\x6e\137\x72\x65\155\145\155\x62\145\162\145\x64\137\165\163\x65\162\x5f\163\165\x63\143\145\163\163\x66\x75\x6c"]); goto mmlAf; YCABi: $this->clear_forgotten_password_code($identity); goto p_sZJ; Sc2gX: if (!($query->num_rows() === 1)) { goto Aj_fI; } goto dnqLR; dVkyH: $this->set_session($user); goto YCABi; dnqLR: $user = $query->row(); goto ObW5J; IAy25: $this->trigger_events("\x70\162\145\137\154\x6f\x67\x69\x6e\137\x72\145\x6d\145\155\142\145\x72\x65\x64\137\165\163\x65\162"); goto ppiNd; ppiNd: $remember_cookie = get_cookie($this->config->item("\x72\145\x6d\x65\155\x62\145\162\137\143\157\x6f\x6b\151\x65\x5f\156\141\x6d\x65", "\x69\x6f\156\x5f\141\x75\164\x68")); goto Nj3RQ; bcOhT: $this->update_last_login($user->id); goto dVkyH; J9V9a: T5gN4: goto QouIG; SCyyT: return FALSE; goto n_3B0; lHcLz: $this->trigger_events(["\160\157\163\164\x5f\154\x6f\x67\151\x6e\137\x72\x65\155\x65\155\x62\145\x72\x65\144\137\x75\x73\x65\x72", "\x70\157\x73\164\137\x6c\157\x67\x69\x6e\137\162\x65\x6d\145\x6d\142\x65\x72\145\144\137\165\163\145\162\137\165\x6e\x73\165\x63\x63\x65\x73\163\146\x75\154"]); goto uGUp_; iwKaD: $this->trigger_events("\145\170\x74\162\141\137\x77\x68\x65\x72\145"); goto Vy8hf; r0nHv: if (!($token === FALSE)) { goto iVVga; } goto lHcLz; QouIG: $this->session->sess_regenerate(FALSE); goto HrVaX; AjleD: rqcFL: goto QIS29; Zff4x: delete_cookie($this->config->item("\x72\145\155\145\x6d\142\145\x72\x5f\143\157\x6f\153\x69\x65\x5f\156\141\x6d\145", "\151\x6f\156\x5f\141\165\x74\x68")); goto zx5Qv; RhAP8: iVVga: goto iwKaD; zx5Qv: $this->trigger_events(["\x70\157\163\x74\x5f\x6c\x6f\147\x69\x6e\x5f\x72\145\x6d\x65\x6d\142\x65\x72\x65\144\137\x75\x73\145\x72", "\x70\x6f\163\164\137\154\x6f\x67\x69\156\137\x72\145\x6d\145\155\142\145\x72\145\x64\x5f\x75\x73\x65\162\137\165\156\163\165\143\x63\145\163\163\x66\x75\x6c"]); goto SCyyT; mmlAf: return TRUE; goto AjleD; MoGVY: $this->remember_user($identity); goto J9V9a; p_sZJ: if (!$this->config->item("\x75\x73\x65\x72\137\145\170\164\x65\156\144\x5f\157\x6e\x5f\154\157\x67\x69\156", "\151\x6f\x6e\137\141\165\164\150")) { goto T5gN4; } goto MoGVY; RZMwK: if (!$this->verify_password($token->validator, $user->remember_code, $identity)) { goto rqcFL; } goto bcOhT; uGUp_: return FALSE; goto RhAP8; QIS29: Aj_fI: goto Zff4x; ObW5J: $identity = $user->{$this->identity_column}; goto RZMwK; n_3B0: } public function create_group($group_name = FALSE, $group_description = '', $additional_data = array()) { goto h9G8C; GYqA5: $this->set_error("\147\162\x6f\165\x70\x5f\141\x6c\x72\x65\x61\144\171\137\x65\x78\x69\x73\x74\163"); goto jU5Hz; ttjn0: $existing_group = $this->db->get_where($this->tables["\x67\162\x6f\165\160\x73"], ["\156\141\155\x65" => $group_name])->num_rows(); goto aws5M; Ex2Xl: $data = ["\x6e\x61\x6d\x65" => $group_name, "\144\x65\163\143\x72\151\x70\x74\151\x6f\156" => $group_description]; goto JWEOf; V7w0G: $this->set_message("\x67\x72\x6f\165\160\137\143\x72\145\x61\x74\x69\x6f\x6e\137\x73\x75\x63\x63\x65\163\x73\146\x75\x6c"); goto eFzFD; aws5M: if (!($existing_group !== 0)) { goto rHQlj; } goto GYqA5; h9G8C: if ($group_name) { goto b2XBV; } goto YUD8_; JWEOf: if (empty($additional_data)) { goto mNAYR; } goto ON7gI; jU5Hz: return FALSE; goto PJIFN; KB1gd: b2XBV: goto ttjn0; eFzFD: return $group_id; goto iEG3r; ojodC: mNAYR: goto oF7iC; YUD8_: $this->set_error("\x67\x72\x6f\x75\x70\x5f\156\x61\155\145\x5f\x72\x65\161\x75\151\162\x65\144"); goto seYNQ; ON7gI: $data = array_merge($this->_filter_data($this->tables["\x67\162\x6f\x75\x70\163"], $additional_data), $data); goto ojodC; fNsHY: $this->db->insert($this->tables["\147\162\x6f\165\160\163"], $data); goto AzxAG; seYNQ: return FALSE; goto KB1gd; PJIFN: rHQlj: goto Ex2Xl; oF7iC: $this->trigger_events("\x65\170\164\162\141\137\147\x72\x6f\x75\160\137\163\145\x74"); goto fNsHY; AzxAG: $group_id = $this->db->insert_id($this->tables["\147\162\x6f\x75\160\163"] . "\137\x69\x64\137\163\x65\x71"); goto V7w0G; iEG3r: } public function update_group($group_id = FALSE, $group_name = FALSE, $additional_data = array()) { goto NExX2; zZXIR: $this->set_error("\x67\162\x6f\165\160\x5f\156\141\x6d\x65\x5f\141\x64\155\151\156\x5f\156\157\164\x5f\141\x6c\x74\145\162"); goto UMB8x; ZdFfc: Bpd6R: goto cM7N3; tZ87q: FnQuV: goto BDa8f; ckksr: $existing_group = $this->db->get_where($this->tables["\x67\x72\x6f\x75\x70\x73"], ["\x6e\x61\x6d\145" => $group_name])->row(); goto qOW9c; qOW9c: if (!(isset($existing_group->id) && $existing_group->id != $group_id)) { goto FnQuV; } goto CeuMn; Iac8a: Fx03A: goto IkyHm; BDa8f: $data["\156\x61\155\145"] = $group_name; goto rwuP8; e5sHJ: $this->db->update($this->tables["\x67\x72\157\x75\x70\163"], $data, ["\x69\x64" => $group_id]); goto qhM6Z; cM7N3: if (empty($additional_data)) { goto oItUt; } goto dOff6; qhM6Z: $this->set_message("\147\162\x6f\x75\x70\x5f\x75\160\x64\x61\x74\145\x5f\163\165\143\143\145\x73\x73\146\165\x6c"); goto yblZK; YRuGI: return FALSE; goto Iac8a; IkyHm: $data = []; goto CGXEp; UMB8x: return FALSE; goto ZdFfc; yblZK: return TRUE; goto bchfo; rwuP8: IfFE4: goto aJqcA; aJqcA: $group = $this->db->get_where($this->tables["\147\x72\x6f\165\x70\163"], ["\151\144" => $group_id])->row(); goto qiwtu; NExX2: if (!empty($group_id)) { goto Fx03A; } goto YRuGI; vhTPb: oItUt: goto e5sHJ; wpWKb: return FALSE; goto tZ87q; CeuMn: $this->set_error("\x67\162\x6f\165\160\x5f\141\154\162\x65\141\x64\x79\137\145\170\x69\x73\164\x73"); goto wpWKb; dOff6: $data = array_merge($this->_filter_data($this->tables["\147\162\157\x75\x70\x73"], $additional_data), $data); goto vhTPb; CGXEp: if (empty($group_name)) { goto IfFE4; } goto ckksr; qiwtu: if (!($this->config->item("\x61\144\155\151\x6e\x5f\x67\162\x6f\165\x70", "\x69\157\156\x5f\x61\x75\164\150") === $group->name && $group_name !== $group->name)) { goto Bpd6R; } goto zZXIR; bchfo: } public function delete_group($group_id = FALSE) { goto d4SIY; o9PZi: return FALSE; goto s1hiJ; m98ft: $group = $this->group($group_id)->row(); goto RzpKE; qLlam: $this->set_message("\x67\x72\157\165\x70\137\x64\145\154\145\x74\145\137\x73\165\x63\143\x65\x73\x73\146\x75\x6c"); goto xOrlP; JzFyb: if (!($this->db->trans_status() === FALSE)) { goto i1JzY; } goto wNzcR; pc_e5: $this->db->delete($this->tables["\165\x73\145\x72\163\137\x67\162\x6f\x75\x70\163"], [$this->join["\x67\x72\x6f\x75\x70\x73"] => $group_id]); goto CFDIM; xOrlP: return TRUE; goto XwsWN; d4SIY: if (!(!$group_id || empty($group_id))) { goto CsHOM; } goto KF7wP; CFDIM: $this->db->delete($this->tables["\x67\162\157\x75\160\163"], ["\151\x64" => $group_id]); goto JzFyb; T6eUL: $this->trigger_events(["\160\x6f\163\x74\137\144\x65\x6c\145\164\x65\137\x67\162\x6f\165\160", "\160\157\x73\164\x5f\x64\145\x6c\x65\x74\x65\137\x67\162\157\165\160\x5f\x6e\157\164\141\154\x6c\x6f\167\x65\144"]); goto rpK88; rpK88: $this->set_error("\x67\x72\x6f\x75\x70\137\x64\145\x6c\x65\x74\x65\x5f\x6e\x6f\x74\x61\154\x6c\157\x77\x65\144"); goto aBl1U; wNzcR: $this->db->trans_rollback(); goto MVH2d; s1hiJ: i1JzY: goto hAZ_L; hAZ_L: $this->db->trans_commit(); goto Jk0_S; B3Vpj: CsHOM: goto m98ft; jr5k6: $this->set_error("\x67\162\x6f\x75\x70\137\x64\145\x6c\x65\x74\145\x5f\165\x6e\163\165\x63\x63\145\163\163\146\165\x6c"); goto o9PZi; aBl1U: return FALSE; goto aLSzv; RzpKE: if (!($group->name == $this->config->item("\x61\144\155\x69\156\137\147\x72\x6f\x75\x70", "\151\157\156\x5f\x61\165\x74\150"))) { goto nIUIz; } goto T6eUL; KF7wP: return FALSE; goto B3Vpj; tekHm: $this->trigger_events("\x70\162\x65\137\x64\145\154\145\x74\x65\137\x67\x72\157\x75\x70"); goto Tw1Wh; MVH2d: $this->trigger_events(["\x70\x6f\x73\164\x5f\x64\145\x6c\x65\164\x65\x5f\147\x72\x6f\165\x70", "\x70\157\x73\x74\x5f\x64\145\x6c\x65\x74\145\x5f\x67\162\157\165\x70\x5f\x75\156\163\165\143\143\145\163\x73\146\165\x6c"]); goto jr5k6; Jk0_S: $this->trigger_events(["\160\x6f\163\x74\x5f\144\145\154\145\164\145\x5f\x67\162\157\x75\160", "\160\157\163\x74\x5f\x64\145\154\145\164\x65\x5f\147\x72\x6f\x75\x70\137\163\x75\x63\143\145\163\x73\146\x75\x6c"]); goto qLlam; Tw1Wh: $this->db->trans_begin(); goto pc_e5; aLSzv: nIUIz: goto tekHm; XwsWN: } public function set_hook($event, $name, $class, $method, $arguments) { goto icuMP; W5VZ3: $this->_ion_hooks->{$event}[$name]->class = $class; goto GKfCw; GKfCw: $this->_ion_hooks->{$event}[$name]->method = $method; goto NYFQc; icuMP: $this->_ion_hooks->{$event}[$name] = new stdClass(); goto W5VZ3; NYFQc: $this->_ion_hooks->{$event}[$name]->arguments = $arguments; goto vQOZu; vQOZu: } public function remove_hook($event, $name) { goto t1nEW; ttzBY: jbFWZ: goto EDLNE; C1xqM: unset($this->_ion_hooks->{$event}[$name]); goto ttzBY; t1nEW: if (!isset($this->_ion_hooks->{$event}[$name])) { goto jbFWZ; } goto C1xqM; EDLNE: } public function remove_hooks($event) { goto AfKp_; AfKp_: if (!isset($this->_ion_hooks->{$event})) { goto fwIX9; } goto nWojz; nWojz: unset($this->_ion_hooks->{$event}); goto GCzmg; GCzmg: fwIX9: goto L0bFz; L0bFz: } protected function _call_hook($event, $name) { goto iG9Uy; EzsaF: ycIWO: goto SmBJG; iZVqa: return call_user_func_array([$hook->class, $hook->method], $hook->arguments); goto EzsaF; SmBJG: return FALSE; goto pyBe6; W40VC: $hook = $this->_ion_hooks->{$event}[$name]; goto iZVqa; iG9Uy: if (!(isset($this->_ion_hooks->{$event}[$name]) && method_exists($this->_ion_hooks->{$event}[$name]->class, $this->_ion_hooks->{$event}[$name]->method))) { goto ycIWO; } goto W40VC; pyBe6: } public function trigger_events($events) { goto xJOHR; KagLK: if (!(isset($this->_ion_hooks->{$events}) && !empty($this->_ion_hooks->{$events}))) { goto etS5P; } goto Loqx2; Loqx2: foreach ($this->_ion_hooks->{$events} as $name => $hook) { $this->_call_hook($events, $name); pKtrp: } goto yrtF7; yrtF7: LFEie: goto Fj4wx; Fj4wx: etS5P: goto RA0Cp; m043L: gmWP9: goto thJ7X; lYlEi: l3K9y: goto FQDP5; FQDP5: qJU3r: goto h8Ajw; xJOHR: if (is_array($events) && !empty($events)) { goto gmWP9; } goto KagLK; RA0Cp: goto qJU3r; goto m043L; thJ7X: foreach ($events as $event) { $this->trigger_events($event); HA9w0: } goto lYlEi; h8Ajw: } public function set_message_delimiters($start_delimiter, $end_delimiter) { goto hExcn; hExcn: $this->message_start_delimiter = $start_delimiter; goto C7M9m; C7M9m: $this->message_end_delimiter = $end_delimiter; goto PYeKn; PYeKn: return TRUE; goto nj9Ne; nj9Ne: } public function set_error_delimiters($start_delimiter, $end_delimiter) { goto MmVUL; JaXrq: return TRUE; goto K11pl; MmVUL: $this->error_start_delimiter = $start_delimiter; goto BTkpJ; BTkpJ: $this->error_end_delimiter = $end_delimiter; goto JaXrq; K11pl: } public function set_message($message) { $this->messages[] = $message; return $message; } public function messages() { goto Sc1JH; N1tzR: foreach ($this->messages as $message) { goto JUigN; JUigN: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\x23"; goto Yn2Xg; Yn2Xg: $_output .= $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto u67N7; u67N7: e8xWG: goto G2aq6; G2aq6: } goto FV0ES; MjDLy: return $_output; goto EKlvJ; Sc1JH: $_output = ''; goto N1tzR; FV0ES: a2Vxh: goto MjDLy; EKlvJ: } public function messages_array($langify = TRUE) { goto nd1iw; a_vsd: return $this->messages; goto lzsGW; mS2QD: $_output = []; goto s2r3t; OrqfS: tNJZO: goto mS2QD; bkiYr: dP3FV: goto vYWbi; ekPcc: ceLHe: goto Z1SxO; vYWbi: return $_output; goto ekPcc; lzsGW: goto ceLHe; goto OrqfS; s2r3t: foreach ($this->messages as $message) { goto PhlfV; sbRJE: toBr6: goto VaeGQ; PhlfV: $messageLang = $this->lang->line($message) ? $this->lang->line($message) : "\x23\43" . $message . "\43\x23"; goto pG0mN; pG0mN: $_output[] = $this->message_start_delimiter . $messageLang . $this->message_end_delimiter; goto sbRJE; VaeGQ: } goto bkiYr; nd1iw: if ($langify) { goto tNJZO; } goto a_vsd; Z1SxO: } public function clear_messages() { $this->messages = []; return TRUE; } public function set_error($error) { $this->errors[] = $error; return $error; } public function errors() { goto Vn_8c; iv5gu: return $_output; goto vUjKv; Vn_8c: $_output = ''; goto hwu0u; hwu0u: foreach ($this->errors as $error) { goto N608O; N608O: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\43"; goto aNTFP; GVGLB: Hipzt: goto gJkft; aNTFP: $_output .= $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto GVGLB; gJkft: } goto KN_SH; KN_SH: cECRA: goto iv5gu; vUjKv: } public function errors_array($langify = TRUE) { goto q0_3V; q0_3V: if ($langify) { goto dlGoI; } goto ZHCfv; AQFCV: goto aKXha; goto XK0DO; CQSY0: YXfK4: goto Y2Z6J; YrMj2: $_output = []; goto q4L4_; ZHCfv: return $this->errors; goto AQFCV; Y_iVc: aKXha: goto GZXh4; Y2Z6J: return $_output; goto Y_iVc; XK0DO: dlGoI: goto YrMj2; q4L4_: foreach ($this->errors as $error) { goto YdEGI; Co0av: Ng6PD: goto Ew03L; YdEGI: $errorLang = $this->lang->line($error) ? $this->lang->line($error) : "\x23\x23" . $error . "\43\x23"; goto zuPlX; zuPlX: $_output[] = $this->error_start_delimiter . $errorLang . $this->error_end_delimiter; goto Co0av; Ew03L: } goto CQSY0; GZXh4: } public function clear_errors() { $this->errors = []; return TRUE; } protected function _set_password_db($identity, $password) { goto j98ZD; CrbnL: if (!($hash === FALSE)) { goto VXE1h; } goto UAspy; j98ZD: $hash = $this->hash_password($password, $identity); goto CrbnL; NkHtk: VXE1h: goto o5hwL; UAspy: return FALSE; goto NkHtk; o5hwL: $data = ["\160\x61\x73\x73\x77\x6f\x72\144" => $hash, "\162\x65\155\x65\155\142\145\x72\137\143\x6f\x64\x65" => NULL, "\146\x6f\162\x67\157\x74\x74\x65\x6e\137\160\141\163\163\x77\x6f\x72\144\137\x63\x6f\x64\145" => NULL, "\146\157\162\x67\157\x74\x74\x65\156\137\x70\x61\163\163\167\157\162\x64\x5f\x74\x69\x6d\145" => NULL]; goto Zsrqg; CHtzo: return $this->db->affected_rows() == 1; goto TdI4f; EwyHa: $this->db->update($this->tables["\x75\x73\x65\162\x73"], $data, [$this->identity_column => $identity]); goto CHtzo; Zsrqg: $this->trigger_events("\x65\x78\x74\162\141\137\x77\150\x65\x72\145"); goto EwyHa; TdI4f: } protected function _filter_data($table, $data) { goto ajucJ; gaN2L: return $filtered_data; goto E6DpQ; czWDM: foreach ($columns as $column) { goto XM1oT; Ls0zx: Jtlc2: goto w198r; qN6kP: $filtered_data[$column] = $data[$column]; goto Ls0zx; w198r: yDT3s: goto EZYXG; XM1oT: if (!array_key_exists($column, $data)) { goto Jtlc2; } goto qN6kP; EZYXG: } goto fSLuc; C_P_S: if (!is_array($data)) { goto Kx7wU; } goto czWDM; nHGEW: $columns = $this->db->list_fields($table); goto C_P_S; fSLuc: T0SDs: goto Aac6e; ajucJ: $filtered_data = []; goto nHGEW; Aac6e: Kx7wU: goto gaN2L; E6DpQ: } protected function _random_token($result_length = 32) { goto d54Q4; nFVrD: czjbx: goto JF1KJ; faWgZ: qgBG_: goto Ed5tC; JF1KJ: if (!function_exists("\x6f\160\145\156\163\163\x6c\137\x72\x61\x6e\144\x6f\155\137\x70\x73\x65\x75\x64\157\x5f\x62\171\164\145\163")) { goto UDJO9; } goto H9V03; H9V03: return bin2hex(openssl_random_pseudo_bytes($result_length / 2)); goto j6kV4; d54Q4: if (!(!isset($result_length) || intval($result_length) <= 8)) { goto qgBG_; } goto GV4h0; Ed5tC: if (!function_exists("\x72\x61\x6e\x64\157\x6d\x5f\142\171\164\x65\x73")) { goto tnRSq; } goto Spefg; GV4h0: $result_length = 32; goto faWgZ; lE2E3: return bin2hex(mcrypt_create_iv($result_length / 2, MCRYPT_DEV_URANDOM)); goto nFVrD; puWzX: return FALSE; goto mr1kD; XUWXk: if (!function_exists("\x6d\x63\162\171\160\164\x5f\143\162\145\x61\x74\145\x5f\151\x76")) { goto czjbx; } goto lE2E3; MlfZC: tnRSq: goto XUWXk; Spefg: return bin2hex(random_bytes($result_length / 2)); goto MlfZC; j6kV4: UDJO9: goto puWzX; mr1kD: } protected function _get_hash_parameters($identity = NULL) { goto un5my; srIiR: MFJHl: goto URBPb; neo9M: switch ($this->hash_method) { case "\x62\x63\x72\171\x70\x74": $params = ["\x63\x6f\163\164" => $is_admin ? $this->config->item("\x62\143\x72\x79\160\x74\137\x61\x64\155\x69\x6e\x5f\143\x6f\x73\x74", "\x69\157\156\137\x61\x75\x74\x68") : $this->config->item("\x62\x63\x72\x79\x70\x74\x5f\x64\x65\x66\141\165\154\164\137\x63\157\x73\164", "\x69\x6f\x6e\x5f\x61\165\164\150")]; goto P7IYx; case "\141\162\x67\x6f\x6e\x32": $params = $is_admin ? $this->config->item("\141\162\147\157\x6e\x32\137\141\x64\155\151\156\x5f\x70\141\162\141\x6d\x73", "\x69\157\156\x5f\141\165\x74\150") : $this->config->item("\141\x72\x67\x6f\x6e\x32\x5f\x64\145\x66\x61\165\x6c\x74\x5f\x70\x61\x72\141\x6d\163", "\151\157\x6e\137\x61\165\164\150"); goto P7IYx; default: } goto srIiR; un5my: $is_admin = FALSE; goto ggHas; jnf5C: $params = FALSE; goto neo9M; URBPb: P7IYx: goto KWtRU; bWHmc: WAtf4: goto jnf5C; fgvub: $user_id = $this->get_user_id_from_identity($identity); goto XE7Fc; WYGPe: u3REJ: goto bWHmc; KWtRU: return $params; goto Ir_d3; ggHas: if (!$identity) { goto WAtf4; } goto fgvub; eG2EO: $is_admin = TRUE; goto WYGPe; XE7Fc: if (!($user_id && $this->in_group($this->config->item("\141\144\x6d\x69\x6e\x5f\147\x72\157\165\160", "\151\157\156\x5f\x61\x75\164\x68"), $user_id))) { goto u3REJ; } goto eG2EO; Ir_d3: } protected function _get_hash_algo() { goto fUVhp; Qd_l2: iqnMD: goto lf09K; lf09K: return $algo; goto PRaMI; ktFvN: q5sgE: goto Qd_l2; DsnAc: switch ($this->hash_method) { case "\x62\x63\162\x79\160\164": $algo = PASSWORD_BCRYPT; goto iqnMD; case "\x61\162\147\157\x6e\62": $algo = PASSWORD_ARGON2I; goto iqnMD; default: } goto ktFvN; fUVhp: $algo = FALSE; goto DsnAc; PRaMI: } protected function _generate_selector_validator_couple($selector_size = 40, $validator_size = 128) { goto TWnQ0; WC__b: $validator_hashed = $this->hash_password($validator); goto sCQT6; mYRXQ: return (object) ["\x73\145\154\x65\x63\x74\x6f\162" => $selector, "\166\x61\154\151\x64\141\x74\x6f\x72\x5f\150\x61\163\x68\145\144" => $validator_hashed, "\165\163\x65\162\137\x63\x6f\x64\x65" => $user_code]; goto x9Q1t; sCQT6: $user_code = "{$selector}\x2e{$validator}"; goto mYRXQ; TWnQ0: $selector = $this->_random_token($selector_size); goto iMyBx; iMyBx: $validator = $this->_random_token($validator_size); goto WC__b; x9Q1t: } protected function _retrieve_selector_validator_couple($user_code) { goto pd1cR; X34jE: return FALSE; goto jt_NP; huACv: lEQ2d: goto X34jE; DKo3o: hm10J: goto huACv; Fnram: return (object) ["\x73\145\x6c\145\x63\x74\x6f\162" => $tokens[0], "\x76\x61\x6c\x69\x64\x61\x74\x6f\x72" => $tokens[1]]; goto DKo3o; aNcOv: if (!(count($tokens) === 2)) { goto hm10J; } goto Fnram; y3iBI: $tokens = explode("\x2e", $user_code); goto aNcOv; pd1cR: if (!$user_code) { goto lEQ2d; } goto y3iBI; jt_NP: } protected function _password_verify_sha1_legacy($identity, $password, $hashed_password_db) { goto wj98i; Gl4Uz: $salt_db = $query->row(); goto zsgDj; qF9hw: lki3L: goto lAJwx; zsgDj: if (!($query->num_rows() !== 1)) { goto G7RR2; } goto jLrNA; ZStUD: $salt = substr($hashed_password_db, 0, $salt_length); goto PLjdw; lAJwx: if ($hashed_password === $hashed_password_db) { goto QQAme; } goto PLHOd; PaDAc: return FALSE; goto iwawK; hL1CI: $salt_length = $this->config->item("\x73\x61\154\164\137\154\x65\x6e\147\x74\150", "\151\x6f\156\x5f\141\x75\x74\150"); goto aImt6; sI5_l: if ($result) { goto B2MF0; } goto kfNMj; iwawK: G7RR2: goto zsgK0; w4jwq: return FALSE; goto Q5ZXy; XA3vc: T54Hm: goto X0LKD; PLHOd: $this->trigger_events(["\160\x6f\163\x74\137\x73\x68\x61\61\x5f\160\141\x73\163\167\x6f\x72\x64\137\155\151\x67\162\x61\x74\x69\x6f\x6e", "\160\x6f\163\x74\x5f\x73\150\x61\61\x5f\x70\141\x73\163\167\x6f\x72\144\137\x6d\151\147\x72\141\x74\x69\x6f\x6e\137\x75\156\163\165\x63\x63\x65\163\163\x66\165\x6c"]); goto SH4Ud; xEVmH: B2MF0: goto Qc9cz; VWbE1: return $result; goto XA3vc; zsgK0: $hashed_password = sha1($password . $salt_db->salt); goto qF9hw; PLjdw: $hashed_password = $salt . substr(sha1($salt . $password), 0, -$salt_length); goto FOnT2; Q5ZXy: WrVFN: goto ZStUD; yKEzm: goto Hkzml; goto xEVmH; FOnT2: goto lki3L; goto Bz72J; PDCsI: $result = $this->_set_password_db($identity, $password); goto sI5_l; yMYvc: $this->trigger_events(["\160\x6f\163\164\x5f\163\150\x61\61\137\x70\141\x73\x73\167\157\x72\144\x5f\x6d\x69\147\x72\x61\x74\x69\157\156", "\x70\x6f\163\164\137\x73\x68\x61\61\x5f\160\x61\x73\x73\167\x6f\162\x64\x5f\155\151\x67\x72\x61\x74\x69\x6f\x6e\x5f\165\x6e\x73\165\143\x63\145\x73\x73\146\165\154"]); goto w4jwq; E9gKX: Hkzml: goto VWbE1; hS19x: $query = $this->db->select("\163\141\x6c\164")->where($this->identity_column, $identity)->limit(1)->get($this->tables["\x75\163\x65\162\x73"]); goto Gl4Uz; bi16F: goto T54Hm; goto hM85s; Qc9cz: $this->trigger_events(["\x70\157\x73\164\x5f\163\150\141\61\x5f\160\141\163\163\167\157\162\144\137\155\x69\147\x72\x61\164\x69\x6f\x6e", "\160\x6f\x73\x74\x5f\x73\150\x61\x31\137\x70\x61\x73\x73\167\x6f\x72\144\x5f\x6d\x69\147\162\x61\x74\151\x6f\x6e\x5f\163\x75\x63\143\x65\163\163\x66\x75\154"]); goto E9gKX; kfNMj: $this->trigger_events(["\x70\157\x73\x74\x5f\x73\150\141\x31\137\160\x61\x73\x73\167\x6f\x72\144\137\155\151\x67\x72\141\164\x69\157\156", "\x70\157\163\x74\x5f\x73\x68\x61\x31\137\160\141\163\163\167\x6f\x72\x64\137\x6d\151\147\162\x61\164\151\x6f\156\137\x75\x6e\x73\165\x63\x63\x65\x73\x73\x66\x75\x6c"]); goto yKEzm; SH4Ud: return FALSE; goto bi16F; cWUAr: if ($this->config->item("\x73\x74\157\x72\145\x5f\163\141\x6c\x74", "\151\157\156\137\141\165\164\150")) { goto XaD4i; } goto hL1CI; hM85s: QQAme: goto PDCsI; Bz72J: XaD4i: goto hS19x; jLrNA: $this->trigger_events(["\160\157\163\164\137\163\x68\141\x31\x5f\160\141\x73\x73\x77\x6f\x72\144\x5f\155\151\147\162\141\x74\x69\157\x6e", "\160\x6f\x73\x74\x5f\163\150\141\x31\x5f\x70\141\163\163\x77\157\x72\x64\137\x6d\x69\147\162\141\x74\151\157\156\x5f\165\x6e\163\x75\x63\x63\x65\x73\163\146\165\154"]); goto PaDAc; aImt6: if ($salt_length) { goto WrVFN; } goto yMYvc; wj98i: $this->trigger_events("\160\x72\x65\x5f\163\x68\x61\x31\x5f\x70\141\x73\163\167\157\x72\144\x5f\155\151\x67\162\141\164\x69\x6f\x6e"); goto cWUAr; X0LKD: } }
