<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 class Cbttoken extends CI_Controller { public function __construct() { goto LdCep; JPqYB: show_error("\110\x61\156\171\141\x20\101\x64\155\151\156\x69\x73\164\162\x61\x74\157\162\x20\x79\x61\x6e\x67\x20\x64\151\x62\x65\x72\x69\40\x68\141\153\40\x75\x6e\x74\165\153\x20\155\145\156\x67\141\x6b\163\145\163\x20\x68\x61\x6c\141\x6d\x61\156\x20\x69\156\151\x2c\x20\74\141\40\x68\x72\x65\146\x3d\x22" . base_url("\144\141\163\150\x62\157\x61\x72\144") . "\x22\x3e\x4b\x65\x6d\x62\x61\154\x69\x20\x6b\x65\x20\155\145\x6e\165\40\x61\167\x61\x6c\x3c\x2f\141\76", 403, "\101\153\x73\x65\x73\x20\124\145\x72\x6c\x61\162\x61\x6e\147"); goto lb62o; Qvtwl: if (!(!$this->ion_auth->is_admin() && !$this->ion_auth->in_group("\147\165\x72\x75"))) { goto wjhW9; } goto JPqYB; lb62o: wjhW9: goto XEloC; jJcF7: $this->load->dbforge(); goto Z7q_D; xlBnv: $this->load->model("\x4c\157\x67\x5f\155\x6f\x64\x65\154", "\154\157\x67\x67\x69\x6e\147"); goto zFEAo; zFEAo: $this->form_validation->set_error_delimiters('', ''); goto e20CD; JkLMZ: frbFi: goto Wo_S5; Wo_S5: $this->load->library(["\x64\141\164\x61\x74\141\x62\154\145\163", "\x66\157\x72\x6d\137\x76\x61\x6c\x69\144\141\x74\151\157\156"]); goto ddyRW; IEuYL: redirect("\141\165\x74\150"); goto JkLMZ; ddyRW: $this->load->model("\x4d\x61\163\164\145\x72\137\155\x6f\144\x65\154", "\155\141\163\164\x65\x72"); goto hEFmO; Z7q_D: if (!$this->ion_auth->logged_in()) { goto Pd8kD; } goto Qvtwl; LdCep: parent::__construct(); goto jJcF7; XEloC: goto frbFi; goto vkb2y; vkb2y: Pd8kD: goto IEuYL; Ongy0: $this->load->model("\x43\142\x74\x5f\155\157\144\x65\154", "\x63\142\x74"); goto xlBnv; hEFmO: $this->load->model("\104\141\163\x68\142\x6f\x61\162\x64\x5f\155\157\x64\x65\x6c", "\x64\141\x73\150\x62\157\141\x72\144"); goto Ongy0; e20CD: } public function output_json($data, $encode = true) { goto oXf17; oXf17: if (!$encode) { goto dFnFL; } goto tUUu4; xNkyL: dFnFL: goto TI3iU; TI3iU: $this->output->set_content_type("\141\x70\x70\154\x69\143\x61\x74\x69\157\156\x2f\152\x73\x6f\x6e")->set_output($data); goto bTmEB; tUUu4: $data = json_encode($data); goto xNkyL; bTmEB: } public function index() { goto UKSDG; LxJLa: if ($this->ion_auth->is_admin()) { goto EcNFy; } goto Z8r3_; FFS0X: $data["\x74\157\153\145\156"] = $token != null ? $token : json_decode(json_encode($tkn)); goto LxJLa; sdHAD: EcNFy: goto UWGU_; F_l1N: $tp = $this->master->getTahunActive(); goto RC7FP; dhVvV: $data["\x74\160\137\141\x63\164\x69\x76\145"] = $tp; goto vXhUD; K_Mth: $tkn["\145\154\141\x70\x73\145\144"] = "\60\60\x3a\x30\60\x3a\60\60"; goto FFS0X; RC7FP: $smt = $this->master->getSemesterActive(); goto tCvuk; PvXy2: AXIsh: goto ul3vo; Z8r3_: $guru = $this->dashboard->getDataGuruByUserId($user->id, $tp->id_tp, $smt->id_smt); goto Oz9v_; KA2jU: $tkn["\x74\157\x6b\x65\x6e"] = ''; goto u3OGX; HkNHo: $data = ["\x75\163\145\x72" => $user, "\x6a\165\x64\165\154" => "\124\157\x6b\145\156\x20\125\152\151\141\x6e", "\163\165\142\152\165\x64\x75\x6c" => "\124\x6f\153\145\156", "\163\x65\164\x74\x69\156\x67" => $this->dashboard->getSetting()]; goto F_l1N; tCvuk: $data["\x74\160"] = $this->dashboard->getTahun(); goto dhVvV; Oz9v_: $data["\x67\165\162\x75"] = $guru; goto bsl_q; u3OGX: $tkn["\141\x75\x74\157"] = "\60"; goto d78ze; KI05D: $this->load->view("\137\164\145\155\160\154\141\x74\x65\163\57\144\141\x73\x68\142\x6f\141\x72\x64\x2f\x5f\150\145\141\x64\x65\x72", $data); goto XrnYU; b04aw: $token = $this->cbt->getToken(); goto KA2jU; UWGU_: $data["\x70\x72\157\x66\151\154\x65"] = $this->dashboard->getProfileAdmin($user->id); goto KI05D; bsl_q: $this->load->view("\155\x65\x6d\x62\x65\162\x73\57\x67\x75\162\165\57\164\x65\155\x70\154\x61\164\145\x73\57\150\x65\x61\x64\145\162", $data); goto rysxF; d78ze: $tkn["\152\141\x72\141\153"] = "\61"; goto K_Mth; wa5OR: $this->load->view("\x6d\x65\x6d\142\x65\162\163\57\x67\x75\162\165\x2f\164\x65\x6d\x70\154\141\164\x65\x73\57\146\157\x6f\164\145\162"); goto yxfhD; yxfhD: goto AXIsh; goto sdHAD; pQFJE: $data["\163\x6d\x74\x5f\x61\143\x74\151\166\x65"] = $smt; goto b04aw; XrnYU: $this->load->view("\143\x62\164\x2f\x74\157\x6b\x65\156\57\144\141\164\x61"); goto gfgpg; gfgpg: $this->load->view("\137\164\145\155\x70\154\x61\164\145\x73\x2f\144\x61\163\150\x62\x6f\141\162\x64\57\137\146\x6f\x6f\164\145\162"); goto PvXy2; UKSDG: $user = $this->ion_auth->user()->row(); goto HkNHo; rysxF: $this->load->view("\155\145\155\142\145\162\x73\57\147\165\x72\165\x2f\143\142\164\57\x74\157\x6b\x65\x6e\57\144\x61\164\x61"); goto wa5OR; vXhUD: $data["\x73\155\x74"] = $this->dashboard->getSemester(); goto pQFJE; ul3vo: } public function generateToken() { goto Mm0uB; aD8yM: goto ilhcK; goto Q1vgX; qF_uc: if ($force == "\61") { goto X66_0; } goto sH1C5; kR8OV: $post_token->updated = $updated; goto jM3fH; gMcmy: if (!($total_minutes >= $post_token->jarak)) { goto q2FuM; } goto UREgt; sH1C5: $mulai = new DateTime($token->updated); goto Ll29P; ty2WK: $total_minutes += $diff->i; goto gMcmy; jM3fH: $this->cbt->saveToken($post_token); goto Pen3k; V_WbE: $total_minutes += $diff->h * 60; goto ty2WK; Ll29P: $diff = $mulai->diff(new DateTime()); goto TzmdQ; TzmdQ: $total_minutes = $diff->days * 24 * 60; goto V_WbE; ysYM5: $updated = date("\131\55\x6d\55\x64\x20\110\x3a\151\x3a\x73"); goto qF_uc; Ow0Dj: $this->output_json($token); goto FOXNi; Wf0MY: $token = $this->cbt->getToken(); goto bULru; Dnr1C: $token = $this->cbt->getToken(); goto ysYM5; JaPOQ: $force = $this->input->get("\146\x6f\162\x63\145"); goto Dnr1C; HdJ85: ilhcK: goto Wf0MY; Mm0uB: $post_token = json_decode($this->input->get("\144\x61\x74\x61")); goto JaPOQ; LFbhr: $post_token->token = $new; goto kR8OV; afe1Q: $post_token->token = $new; goto heZUB; qAEOp: $new = $this->createNewToken(); goto afe1Q; UREgt: $new = $this->createNewToken(); goto LFbhr; heZUB: $post_token->updated = $updated; goto ZMP3S; Q1vgX: X66_0: goto qAEOp; Pen3k: q2FuM: goto aD8yM; ZMP3S: $this->cbt->saveToken($post_token); goto HdJ85; bULru: $token->now = $updated; goto Ow0Dj; FOXNi: } public function loadToken() { goto bY4gO; EuOe8: if ($token == null) { goto X2gKn; } goto wixqK; wixqK: $token->now = date("\x59\55\x6d\55\144\40\110\x3a\151\72\163"); goto aH0EM; aH0EM: $this->output_json($token); goto v62U2; WdF0r: foreach ($dataflds as $fild) { goto eTxGp; E9HWO: $field = ["\165\x70\144\141\x74\145\x64" => array("\164\x79\160\x65" => "\x56\101\x52\103\110\x41\x52", "\x63\x6f\156\x73\164\162\141\x69\x6e\164" => 20, "\x64\x65\146\x61\x75\154\x74" => '')]; goto RQuZP; DLtSu: xmJlD: goto FXxVT; gwFCU: if (!($fild->type != "\166\141\162\143\x68\141\x72")) { goto h2RYx; } goto E9HWO; Mxhi5: h2RYx: goto DLtSu; eTxGp: if (!($fild->name == "\x75\160\x64\x61\164\x65\144")) { goto xmJlD; } goto gwFCU; FXxVT: F0rQO: goto qOnjc; RQuZP: $table_changed = $this->dbforge->modify_column("\x63\x62\x74\137\164\x6f\153\x65\156", $field); goto Mxhi5; qOnjc: } goto KFZsJ; v62U2: goto IBTyY; goto MWgdK; bY4gO: $dataflds = $this->db->field_data("\x63\x62\x74\137\x74\157\x6b\145\x6e"); goto SHpIN; MWgdK: X2gKn: goto KCTSz; tnfXS: $token = $this->cbt->getToken(); goto EuOe8; KCTSz: $data["\164\x6f\x6b\145\x6e"] = ''; goto QClnX; SHpIN: $table_changed = false; goto WdF0r; EhQLl: $data["\x65\x6c\x61\x70\163\x65\144"] = "\x30\60\x3a\x30\x30\x3a\x30\60"; goto uNYa6; fcqIH: IBTyY: goto bcB9F; QClnX: $data["\141\165\164\157"] = "\x30"; goto EhQLl; KFZsJ: G7Y_6: goto tnfXS; uNYa6: $this->output_json($data); goto fcqIH; bcB9F: } private function createNewToken() { goto aff63; t20W8: VxaDs: goto GSsb1; QCIb0: if (!($i < 6)) { goto Inml3; } goto Cxn31; aff63: $chars = "\x41\102\103\x44\105\x46\107\110\111\x4a\113\x4c\115\x4e\x4f\x50\121\122\123\x54\x55\126\x57\130\x59\132"; goto ZIUZY; PjZHb: return $new_token; goto Dh_VI; GSsb1: $i++; goto MEzq0; joWpf: DLySR: goto QCIb0; we2Rd: $i = 0; goto joWpf; JywDt: Inml3: goto PjZHb; Cxn31: $random_character = $chars[mt_rand(0, $input_length - 1)]; goto Uzg9C; hBUcM: $new_token = ''; goto we2Rd; Uzg9C: $new_token .= $random_character; goto t20W8; ZIUZY: $input_length = strlen($chars); goto hBUcM; MEzq0: goto DLySR; goto JywDt; Dh_VI: } }
