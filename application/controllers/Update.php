<?php
/*   ________________________________________
    |                 GarudaCBT              |
    |    https://github.com/garudacbt/cbt    |
    |________________________________________|
*/
 defined("\x42\101\123\x45\x50\101\x54\110") or exit("\x4e\x6f\40\x64\x69\162\x65\143\164\40\163\143\162\151\x70\164\40\x61\143\x63\145\163\163\40\x61\x6c\x6c\157\167\x65\144"); class Update extends CI_Controller { function __construct() { goto vmgVF; SPvI7: $this->load->database(); goto nhmeY; eiQyZ: include APPPATH . "\143\x6f\x6e\146\151\147\x2f\x64\141\x74\141\x62\141\x73\x65\x2e\x70\150\160"; goto NrrJ6; NrrJ6: $this->load->dbforge(); goto SPvI7; vmgVF: parent::__construct(); goto eiQyZ; nhmeY: $this->load->library("\145\x6e\143\162\x79\x70\164\151\x6f\x6e"); goto jWScy; jWScy: } public function output_json($data, $encode = true) { goto KooSP; KooSP: if (!$encode) { goto YSd0x; } goto Qc31v; Qc31v: $data = json_encode($data); goto I6EEv; CFoIP: $this->output->set_content_type("\x61\160\160\154\151\x63\141\x74\x69\157\156\57\x6a\x73\x6f\156")->set_output($data); goto VHVVK; I6EEv: YSd0x: goto CFoIP; VHVVK: } public function index() { goto KIOQX; sE0Xg: $json = json_decode($json); goto ORyC3; ORyC3: $json = (array) $json; goto Qn6UI; Qn6UI: $data["\152\x73\x6f\x6e"] = $json; goto j5tng; j5tng: $this->load->view("\x69\x6e\x73\x74\x61\x6c\x6c\57\x68\145\141\144\x65\x72", $data); goto QZ1SV; QZ1SV: $this->load->view("\x69\x6e\163\x74\141\x6c\x6c\x2f\165\x70\x64\x61\x74\145"); goto LE_2T; KIOQX: $json = file_get_contents("\56\57\x61\x73\163\x65\x74\x73\x2f\141\160\160\57\144\x62\x2f\144\x61\164\x61\x62\x61\163\x65\x2e\152\163\157\156"); goto sE0Xg; LE_2T: $this->load->view("\x69\x6e\163\x74\141\x6c\154\x2f\x66\x6f\157\x74\x65\162"); goto UgE5F; UgE5F: } function object_to_array($data) { goto FeXa8; fxYPl: $result = []; goto vKbKs; vKbKs: foreach ($data as $key => $value) { $result[$key] = is_array($data) || is_object($data) ? $this->object_to_array($value) : $value; doarK: } goto JcpWj; JcpWj: UVOrU: goto gUd8a; FeXa8: if (!(is_array($data) || is_object($data))) { goto DiO0v; } goto fxYPl; gUd8a: return $result; goto bakFJ; ftJcc: return $data; goto YgfzR; bakFJ: DiO0v: goto ftJcc; YgfzR: } public function checkDatabase() { goto ET1Qh; RgTzn: $tbl_ada = array_keys($fields); goto f49PX; xeg4J: $add_columns = []; goto On9WK; On9WK: $edit_columns = []; goto wqhj9; QwHTL: $json = (array) $json; goto By_Ee; MTnF0: yXZP_: goto oJXbO; IwWbJ: foreach ($tabless as $table) { goto VXEh2; v8TO5: $currentDb[$table] = $retval; goto mG3bG; pHWDX: $retval[$i]->extra = $query[$i]->extra; goto SPo03; j6XsQ: $retval[$i] = new stdClass(); goto s5lSf; kS3L3: $query = $query->result_object(); goto guAkp; PUEXX: CEfiL: goto v8TO5; UHHyb: $c = count($query); goto uoBZ0; q52mG: if (!(($query = $this->db->query($sql)) === FALSE)) { goto mFboD; } goto mIE4u; MXeJZ: goto EpKIp; goto l0ef4; mGJXb: if (!($i < $c)) { goto CEfiL; } goto cZ2n2; ec7_n: $i = 0; goto UHHyb; uoBZ0: kZqDQ: goto mGJXb; fAMgG: goto kZqDQ; goto PUEXX; wSeoO: $datafld[$i]->auto_increment = true; goto GJN7N; s4EaY: o0_Ax: goto eje35; rlGbu: if (!($query[$i]->extra != '')) { goto dRTaq; } goto kcvsd; guAkp: $retval = array(); goto ec7_n; l0ef4: rFm2Y: goto wSeoO; wd5HP: LHMC_: goto j6XsQ; Zq7bo: dRTaq: goto wd5HP; mIE4u: $currentDb = FALSE; goto p1B5o; s80vv: $datafld[$i]->extra = $query[$i]->extra; goto MXeJZ; kcvsd: if ($query[$i]->extra == "\141\x75\164\157\137\x69\x6e\x63\x72\x65\x6d\145\x6e\x74") { goto rFm2Y; } goto s80vv; s5lSf: $retval[$i]->name = $query[$i]->column_name; goto pHWDX; mG3bG: $fields[$table] = $datafld; goto s4EaY; zgBsd: $i++; goto fAMgG; aSxEX: $sql = "\123\105\x4c\105\103\x54\40\x60\143\157\154\165\x6d\156\x5f\x6e\x61\x6d\x65\140\54\x20\x60\x6e\165\x6d\145\162\x69\x63\x5f\160\x72\145\x63\151\163\x69\157\x6e\140\x2c\40\140\x65\x78\x74\162\x61\x60\x2c\x20\x60\x69\x73\x5f\156\165\x6c\x6c\x61\x62\x6c\x65\x60" . "\x20\106\122\117\115\40\140\x69\156\x66\x6f\162\155\x61\164\151\157\156\137\163\143\150\145\x6d\141\x60\56\x60\x63\157\154\165\x6d\156\x73\x60\x20\127\x48\x45\x52\105\x20\164\141\x62\x6c\145\137\x73\143\x68\145\155\x61\40\x3d\x20\x22" . $this->db->database . "\x22\x20\101\x4e\104\40\x74\141\x62\154\x65\137\x6e\x61\x6d\x65\40\75\x20\42" . $table . "\42"; goto q52mG; cZ2n2: if (!($datafld[$i]->name == $query[$i]->column_name)) { goto LHMC_; } goto rlGbu; SPo03: ReWnJ: goto zgBsd; GJN7N: EpKIp: goto Zq7bo; p1B5o: mFboD: goto kS3L3; VXEh2: $datafld = $this->db->field_data($table); goto aSxEX; eje35: } goto MTnF0; Nq1YK: $full_tables = array_unique($full_tables); goto g0LxN; p867b: $create_tables = []; goto xeg4J; rucXX: $currentDb = []; goto IwWbJ; JoxEH: $data = ["\x64\x62" => $fields, "\143\162\145\141\164\145" => $create_tables, "\x6d\157\144\x69\146\171" => $edit_columns, "\x61\144\x64" => $add_columns, "\143\x6f\165\x6e\164\163" => $counts, "\x6a\163\157\156" => $json, "\143\165\x72\x72\145\x6e\x74" => $currentDb]; goto HtT8Q; ET1Qh: $db_debug = $this->db->db_debug; goto jwzxl; EFVF3: $json = json_decode($json); goto QwHTL; Bt_8M: Gfsn8: goto f7PQD; g0LxN: sort($full_tables); goto p867b; By_Ee: $tbl_baru = array_keys($json); goto RgTzn; oJXbO: $json = file_get_contents("\56\x2f\x61\x73\163\x65\164\x73\x2f\141\x70\x70\x2f\144\142\57\144\x61\164\141\142\x61\x73\x65\56\152\163\x6f\156"); goto EFVF3; HtT8Q: $this->output_json($data); goto eeNWQ; ljv6z: $tabless = $this->db->list_tables(); goto TBiwv; wqhj9: foreach ($full_tables as $table) { goto wAu8Z; jJbR4: G9Y88: goto Uw_MB; ecH4u: EYn7v: goto OF0mb; MMdCl: XQCnv: goto o1Yal; wAu8Z: if ($this->db->table_exists($table)) { goto G9Y88; } goto uAaLz; Uw_MB: if (!isset($json[$table])) { goto RZhea; } goto eVvLj; OF0mb: RZhea: goto MMdCl; uAaLz: $create_tables[$table] = $json[$table]; goto QAc3F; QAc3F: goto XQCnv; goto jJbR4; o1Yal: B3EVG: goto Lz_tz; eVvLj: foreach ($json[$table] as $jtbl) { goto Su9y2; m_E6S: QrmTA: goto AIAdg; Su9y2: if ($this->db->field_exists($jtbl->name, $table)) { goto QrmTA; } goto cZJJt; u1e7f: IohD0: goto vQDVQ; H4sa2: MXBgH: goto v9ppl; vQDVQ: pq6ut: goto H4sa2; AIAdg: foreach ($fields[$table] as $ftbl) { goto jJ0s7; szsFH: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto vFkFN; } goto xKWSX; zqAbT: vFkFN: goto aP2uW; jJ0s7: if (!($jtbl->name == $ftbl->name)) { goto APVgj; } goto szsFH; l8o8x: pWqGB: goto hjImb; xKWSX: $edit_columns[$table][] = $jtbl; goto zqAbT; aP2uW: APVgj: goto l8o8x; hjImb: } goto u1e7f; cZJJt: $add_columns[$table][] = $jtbl; goto jG4tt; jG4tt: goto pq6ut; goto m_E6S; v9ppl: } goto ecH4u; Lz_tz: } goto Bt_8M; f49PX: $full_tables = array_merge($tbl_baru, $tbl_ada); goto Nq1YK; jwzxl: $this->db->db_debug = FALSE; goto ljv6z; TBiwv: $fields = []; goto rucXX; f7PQD: $counts = count($create_tables) + count($add_columns) + count($edit_columns); goto JoxEH; eeNWQ: } public function updateDatabase() { goto w4FUe; U39VB: $json = json_decode($json); goto UO3P6; rmUWm: b3n37: goto k40rg; cYEs8: $full_tables = array_unique($full_tables); goto vH5Nq; tzvYL: $json = file_get_contents("\x2e\57\141\163\163\x65\164\x73\x2f\x61\x70\160\x2f\x64\x62\57\144\x61\x74\141\142\141\163\x65\x2e\152\x73\157\x6e"); goto U39VB; w4FUe: $tabless = $this->db->list_tables(); goto zX64i; zX64i: $fields = []; goto FMEn3; SLlmT: $full_tables = array_merge($tbl_baru, $tbl_ada); goto cYEs8; F41eH: $tbl_ada = array_keys($fields); goto SLlmT; NbC3_: $tbl_baru = array_keys($json); goto F41eH; UO3P6: $json = (array) $json; goto NbC3_; k40rg: echo true; goto iY27e; vH5Nq: sort($full_tables); goto fSPxy; fSPxy: foreach ($full_tables as $table) { goto NpYoH; yxxX4: if (!isset($json[$table])) { goto uHa0L; } goto C1Igb; JbYyd: foreach ($json[$table] as $tbl => $jtbl) { goto Moz7s; Tx_9w: ZA7LG: goto Kc4vr; FpLZK: if (!($jtbl->primary_key == 1)) { goto ZA7LG; } goto bzivu; wdSIp: $this->dbforge->add_field($field); goto FpLZK; bzivu: $this->dbforge->add_key($jtbl->name, true); goto Tx_9w; Kc4vr: tiOSR: goto c01sl; Moz7s: $field = [$jtbl->name => ["\x74\x79\160\x65" => $jtbl->type, "\x63\157\x6e\x73\164\162\x61\151\156\x74" => $jtbl->max_length, "\156\x75\x6c\x6c" => $jtbl->primary_key == 0]]; goto wdSIp; c01sl: } goto zsfCm; l3ybq: j1jbJ: goto Qc3pt; jm053: wWiqB: goto gvRUA; hepTb: rOl22: goto Buj5O; Buj5O: uHa0L: goto jm053; KGh4I: $this->db->query("\101\114\x54\105\122\40\x54\x41\x42\x4c\105\x20\x20\140" . $table . "\x60\x20\x45\116\107\111\116\105\40\75\40\111\x6e\156\157\104\102"); goto l3ybq; rx7sX: if (!isset($json[$table])) { goto j1jbJ; } goto JbYyd; TTpQn: nAx61: goto yxxX4; zsfCm: TWSJJ: goto WEc3y; WEc3y: $this->dbforge->create_table($table, TRUE); goto KGh4I; C1Igb: foreach ($json[$table] as $jtbl) { goto ttU7C; XUfSU: yRYlq: goto zi0yl; nJ6PN: if ($jtbl->primary_key == 0) { goto WNNT1; } goto zOHEO; ocpai: $this->dbforge->add_column($table, $field); goto XUfSU; ttU7C: if ($this->db->field_exists($jtbl->name, $table)) { goto HFkn4; } goto nJ6PN; LuaOc: foreach ($fields[$table] as $ftbl) { goto KYFPc; zbEqB: $onUpdate = isset($jtbl->extra) ? "\40" . strtolower($jtbl->extra) : ''; goto Glmry; aU1TU: if ($jtbl->default == "\x43\125\x52\x52\x45\116\124\x5f\124\x49\x4d\105\123\x54\101\115\120") { goto H4sjT; } goto hUIXo; AgwpH: HD63Q: goto re1h8; RETux: $field = array($jtbl->name => array("\x74\171\x70\x65" => $jtbl->type, "\x63\157\156\163\x74\x72\x61\151\x6e\x74" => $jtbl->max_length, "\x6e\x75\x6c\154" => false)); goto DDDw1; e4IoR: $this->dbforge->add_key($jtbl->name, true); goto UJ3pR; MaFmu: goto hgBPM; goto dT1or; EpmXV: $this->dbforge->modify_column($table, $field); goto S9ek9; QEdMF: wMdih: goto bNzB8; re1h8: O1Nmt: goto QvA1p; JLB20: if (!($jtbl->default != $ftbl->default || $jtbl->max_length != $ftbl->max_length || $jtbl->type != $ftbl->type)) { goto oaQpd; } goto cBNeL; Gy2nS: oaQpd: goto AgwpH; ixKFH: if ($jtbl->auto_increment == true) { goto wMdih; } goto RETux; xzSRy: H4sjT: goto zbEqB; cBNeL: if ($jtbl->primary_key == 0) { goto QVHVn; } goto ixKFH; TeINl: Hxyem: goto EpmXV; dT1or: QVHVn: goto aU1TU; Glmry: $field = array($jtbl->name . "\40\x64\141\x74\x65\x74\151\155\145\x20\144\145\146\x61\x75\154\164\x20\143\x75\x72\x72\x65\x6e\x74\x5f\x74\151\x6d\145\163\164\x61\x6d\160" . $onUpdate); goto TeINl; UJ3pR: $this->dbforge->modify_column($table, $field); goto MaFmu; bNzB8: $field = array($jtbl->name => array("\164\x79\x70\x65" => $jtbl->type, "\x63\x6f\x6e\163\x74\162\141\x69\156\x74" => $jtbl->max_length, "\156\165\154\154" => false, "\141\x75\164\x6f\x5f\x69\x6e\x63\162\x65\x6d\145\156\164" => true)); goto KZ11L; KZ11L: rkWdM: goto e4IoR; qNdgR: goto Hxyem; goto xzSRy; KYFPc: if (!($jtbl->name == $ftbl->name)) { goto HD63Q; } goto JLB20; DDDw1: goto rkWdM; goto QEdMF; S9ek9: hgBPM: goto Gy2nS; hUIXo: $field = array($jtbl->name => array("\x74\x79\x70\x65" => $jtbl->type, "\x63\x6f\156\x73\164\x72\141\x69\156\x74" => $jtbl->max_length, "\144\145\146\141\x75\154\164" => $jtbl->default)); goto qNdgR; QvA1p: } goto Q3K3S; Q3K3S: TzZMX: goto Lf2Pj; ygye2: WNNT1: goto neuy_; xLMVA: HFkn4: goto LuaOc; Lf2Pj: aV5U3: goto H1pjM; MV82C: goto yRYlq; goto ygye2; neuy_: $field = array($jtbl->name => array("\x74\171\160\x65" => $jtbl->type, "\143\157\x6e\163\164\162\x61\x69\x6e\164" => $jtbl->max_length, "\144\x65\x66\x61\x75\154\x74" => $jtbl->default)); goto ocpai; H1pjM: lODNe: goto A6N0f; zOHEO: $field = array($jtbl->name => array("\x74\171\x70\x65" => $jtbl->type, "\x63\x6f\x6e\163\x74\x72\x61\151\x6e\164" => $jtbl->max_length, "\156\x75\x6c\154" => false)); goto gOD7R; zi0yl: goto aV5U3; goto xLMVA; gOD7R: $this->dbforge->add_key($jtbl->name, true); goto uVoh9; uVoh9: $this->dbforge->add_column($table, $field); goto MV82C; A6N0f: } goto hepTb; NpYoH: if ($this->db->table_exists($table)) { goto nAx61; } goto rx7sX; gvRUA: z9YmV: goto eEFTH; Qc3pt: goto wWiqB; goto TTpQn; eEFTH: } goto rmUWm; FMEn3: foreach ($tabless as $table) { $fields[$table] = $this->db->field_data($table); mr8Bb: } goto kw9tz; kw9tz: Mfvvb: goto tzvYL; iY27e: } public function checkDb() { goto CMfnq; mLW6W: $add_columns = []; goto Zj0MS; DiKzZ: $this->db->db_debug = $db_debug; goto LaCim; YzQ8S: foreach ($tabless as $table) { goto ZWJii; oNAeH: $c = count($query); goto iAzri; TUJaq: $retval = array(); goto zENnt; D1n_z: $retval[$i]->comment = $query[$i]->column_comment; goto pqMO7; NACtR: if (!($i < $c)) { goto b6fR_; } goto AySZv; cv874: $retval[$i]->name = $query[$i]->column_name; goto cJRTb; UAkMT: $retval[$i]->primary = $query[$i]->column_key; goto jfa1j; zxHGO: $retval[$i]->default = $query[$i]->column_default; goto D1n_z; fk8af: Fke5N: goto WGWhR; PfSmE: goto lZRgz; goto bt74x; WmvYU: $i++; goto PfSmE; zENnt: $i = 0; goto oNAeH; ZWJii: $sql = "\x53\105\114\105\103\x54\40\x60\143\157\154\x75\x6d\x6e\x5f\156\141\x6d\145\x60\x2c\40\140\x63\x6f\154\165\x6d\156\x5f\164\171\x70\145\x60\54\x20\140\143\157\x6c\x6c\141\x74\151\157\156\137\156\141\155\x65\140\x2c\40\140\x64\x61\164\x61\137\164\171\x70\145\140\x2c\40\x60\x63\150\x61\x72\141\143\164\x65\162\137\155\141\x78\x69\155\165\x6d\137\x6c\145\156\x67\164\x68\x60\x2c\40\x60\x6e\165\155\145\162\151\143\x5f\160\162\x65\x63\x69\x73\x69\157\156\x60\54" . "\x20\x60\x63\x6f\x6c\x75\155\x6e\x5f\x64\145\x66\141\165\x6c\164\x60\x2c\x20\140\143\157\154\x75\155\156\x5f\153\x65\171\140\x2c\x20\140\143\157\x6c\x75\x6d\x6e\137\x63\x6f\155\x6d\145\156\164\140\54\x20\140\x65\170\164\162\141\140\x2c\40\x60\x69\x73\x5f\x6e\x75\x6c\154\141\142\x6c\145\x60\15\12\11\11\11\106\122\117\x4d\x20\140\x69\x6e\x66\157\162\x6d\141\x74\x69\x6f\156\x5f\x73\x63\150\145\155\141\140\x2e\140\x63\157\154\165\x6d\x6e\x73\x60\x20\x57\x48\x45\x52\x45\40\164\141\x62\154\x65\x5f\x73\x63\x68\145\155\141\x20\75\x20\42" . $this->db->database . "\42\x20\101\116\x44\40\164\x61\142\x6c\145\x5f\x6e\141\155\145\40\75\x20\x22" . $table . "\42"; goto DcgrQ; WGWhR: $query = $query->result_object(); goto TUJaq; jfa1j: yxkAB: goto WmvYU; F008E: $fields[$table] = (object) ["\164\x61\x62\x6c\145\x5f\156\x61\x6d\x65" => $table, "\143\157\x6c\x75\155\156\163" => $retval]; goto Jh5ma; AySZv: $retval[$i] = new stdClass(); goto cv874; cJRTb: $retval[$i]->col_type = $query[$i]->column_type; goto HtHAH; iAzri: lZRgz: goto NACtR; DcgrQ: if (!(($query = $this->db->query($sql)) === FALSE)) { goto Fke5N; } goto ytrBA; Jh5ma: RyzgI: goto GTiYR; sPOSI: $retval[$i]->nullable = $query[$i]->is_nullable; goto UAkMT; pqMO7: $retval[$i]->extra = $query[$i]->extra; goto sPOSI; Lh625: $retval[$i]->max_length = $query[$i]->character_maximum_length > 0 ? $query[$i]->character_maximum_length : $query[$i]->numeric_precision; goto zxHGO; ytrBA: $fields = FALSE; goto fk8af; bt74x: b6fR_: goto F008E; TxshM: $retval[$i]->collation = $query[$i]->collation_name; goto Lh625; HtHAH: $retval[$i]->type = $query[$i]->data_type; goto TxshM; GTiYR: } goto w3LXD; AFfPj: foreach ($full_tables as $table) { goto zKGq5; um9w1: $pri = ''; goto QtZvP; c_1B2: $script_create_table[$table] = $script; goto RmmmN; Xn2Yf: goto YcN_X; goto BzSu8; mwO7m: $modif_column = []; goto yn0KC; FKWGG: if (!(count($add_column) > 0)) { goto bLKZ5; } goto d1NEf; QtZvP: foreach ($json[$table]->columns as $column) { goto ihgaB; dJaks: IkwFl: goto Ui2kj; G4qD6: W44Zt: goto SzA6_; ihgaB: if ($column->max_length == null) { goto IkwFl; } goto zOErI; BmWoo: $length = ''; goto tbYpl; sfVNo: $comment = $column->comment == '' ? '' : "\40\103\x4f\x4d\115\x45\x4e\124\x20\47" . $column->comment . "\47"; goto Q9ZqG; zOErI: if ($column->type != "\154\157\156\x67\x74\x65\170\x74" && $column->type != "\155\x65\x64\151\165\x6d\164\145\x78\x74" && $column->type != "\164\x65\x78\164") { goto Ia2RV; } goto BmWoo; SzA6_: $nullable = $column->nullable == "\x4e\117" ? "\x20\116\x4f\x54\40\x4e\125\114\114" : ''; goto MP295; MP295: $default = $column->default == null ? '' : "\x20\104\105\x46\101\x55\x4c\x54\x20" . $column->default; goto fQ8P5; ccO9t: Ia2RV: goto nuy0R; aBkKI: GlaXT: goto iIHtW; tbYpl: goto W44Zt; goto dJaks; fQ8P5: $extra = $column->extra == '' ? '' : "\x20" . strtoupper($column->extra); goto sfVNo; Q9ZqG: $script .= "\140" . $column->name . "\140\40" . $column->type . $length . $nullable . $default . $extra . $comment . "\x2c\x20"; goto lEfBS; nu3oE: goto F_IV3; goto uUcdy; zKWB_: goto W44Zt; goto ccO9t; uUcdy: WTLoL: goto A1thS; lEfBS: $pri .= $column->primary != '' ? "\x50\x52\111\x4d\101\122\131\40\x4b\105\131\40\x28\140" . $column->name . "\x60\51" : ''; goto aBkKI; UDLgF: $length = "\x28" . $column->max_length . "\51"; goto nu3oE; Ui2kj: $length = ''; goto zKWB_; A1thS: $length = "\50" . ($column->max_length + 1) . "\x29"; goto Co6QC; nuy0R: if ($column->type == "\151\x6e\164") { goto WTLoL; } goto UDLgF; Co6QC: F_IV3: goto G4qD6; iIHtW: } goto XtOl7; yn0KC: foreach ($json[$table]->columns as $jtbl) { goto Tm_RQ; SL1kh: $length = ''; goto IqgWn; oTFfr: $length = "\x28" . ($jtbl->max_length + 1) . "\51"; goto gZiJl; bkHCd: if ($jtbl->type == "\x69\156\164") { goto WDPiq; } goto tDxJ1; EBKWQ: ki2zo: goto bkHCd; IqgWn: goto hINcN; goto Ywi4L; tDxJ1: $length = "\50" . $jtbl->max_length . "\51"; goto mahkt; Ywi4L: j4ZR5: goto a6e3G; fV9Wy: goto hINcN; goto EBKWQ; lvLiP: QrvLD: goto mXmuC; UczY4: u1_GQ: goto KbKkV; Tm_RQ: if ($this->db->field_exists($jtbl->name, $table)) { goto xxnFy; } goto P0q38; P0q38: $add_columns[$table][] = $jtbl; goto BUQrz; EVfEk: $extra = $jtbl->extra == '' ? '' : "\40" . strtoupper($jtbl->extra); goto WA_sG; WA_sG: if (!(strtoupper($extra) == "\x20\x41\125\x54\x4f\137\x49\116\103\x52\x45\x4d\x45\116\x54")) { goto QrvLD; } goto YzxW_; mahkt: goto oBR3e; goto bKPA6; jdB6R: $nullable = $jtbl->nullable == "\116\x4f" ? "\40\x4e\x4f\x54\40\x4e\125\x4c\114" : ''; goto J1h1a; gZiJl: oBR3e: goto s7_5Z; YzxW_: $extra .= "\x20\120\122\111\x4d\101\x52\x59\40\x4b\105\x59"; goto lvLiP; mXmuC: $comment = $jtbl->comment == '' ? '' : "\x20\x43\117\115\115\105\116\124\40\47" . $jtbl->comment . "\x27"; goto Gcajs; CsI9G: xxnFy: goto OSYPR; J1h1a: $default = $jtbl->default == null ? '' : "\40\104\x45\106\x41\125\x4c\124\40" . $jtbl->default; goto EVfEk; BUQrz: if ($jtbl->max_length == null) { goto j4ZR5; } goto nAjul; Gcajs: array_push($add_column, "\x41\x44\x44\x20\140" . $jtbl->name . "\140\x20" . $jtbl->type . $length . $nullable . $default . $extra . $comment); goto CsI9G; OSYPR: foreach ($fields[$table]->columns as $ftbl) { goto ajGGc; KpWMS: i5BzG: goto EF4qq; ripUd: array_push($modif_column, "\x4d\117\104\111\106\131\40\140" . $jtbl->name . "\x60\x20" . $jtbl->col_type . $nullable . $default . $extra . $comment); goto oP92d; lp82m: $edit_columns[$table][$jtbl->name]["\x6e\x75\154\x6c\141\x62\154\x65"] = $jtbl->nullable; goto WHCDk; YnNY1: if (!($jtbl->extra != null)) { goto i5BzG; } goto f9z5S; sblnC: $edit_columns[$table][$jtbl->name]["\143\x6f\x6c\137\x74\171\160\145"] = $jtbl->col_type; goto RvGeg; nr47W: EYPVY: goto M9McD; YMHi3: xWsAR: goto nr47W; IhnCB: if (!($ftbl->default != null)) { goto o2sFC; } goto hjPPA; EF4qq: if (!($ftbl->extra != null)) { goto rWLc4; } goto WMLAd; f9z5S: $jtbl->extra = str_replace("\50\51", '', $jtbl->extra); goto DNbqt; Xb21O: $edit_columns[$table][$jtbl->name]["\x64\x65\x66\x61\x75\154\164"] = $jtbl->default; goto DMwI4; CL8h7: if (!($jtbl->primary != $ftbl->primary)) { goto EYPVY; } goto fEK5e; DNbqt: $jtbl->extra = strtoupper($jtbl->extra); goto KpWMS; V4Bix: l8CtO: goto SexYp; C2gOX: array_push($modif_column, "\101\104\x44\x20\x55\116\111\121\x55\105\40\113\105\x59\40\x60" . $jtbl->name . "\x60\40\x28\x60" . $jtbl->name . "\x60\x29"); goto YMHi3; BhcQT: $ftbl->extra = strtoupper($ftbl->extra); goto eqmX_; RCFf6: o2sFC: goto GZqZW; WMLAd: $ftbl->extra = str_replace("\x28\51", '', $ftbl->extra); goto BhcQT; WHCDk: NmkYc: goto SHpsb; Tpa8f: $default = $jtbl->default == null ? '' : "\40\x44\105\x46\x41\125\114\124\40" . $jtbl->default; goto DM66Q; urKe2: kvX2Y: goto IhnCB; BWuNM: WQGFa: goto Z_Rpq; twFjn: $edit_columns[$table][$jtbl->name]["\x65\170\164\x72\141"] = $jtbl->extra; goto BWuNM; DMwI4: Sjpfw: goto YnNY1; Z_Rpq: if (!($jtbl->comment != $ftbl->comment)) { goto crQ4s; } goto cxjkk; fEK5e: $edit_columns[$table][$jtbl->name]["\160\x72\151\155\141\162\x79"] = $jtbl->primary; goto jFMja; eqmX_: rWLc4: goto siqhB; q1pk2: array_push($modif_column, "\101\104\104\40\120\122\111\115\101\x52\131\40\x4b\105\x59\x20\50\x60" . $jtbl->name . "\x60\51"); goto AEpKq; cxjkk: $edit_columns[$table][$jtbl->name]["\x63\157\155\x6d\x65\156\x74"] = $jtbl->comment; goto zljgf; RvGeg: TEnNZ: goto iYu0P; A5L7W: $jtbl->default = strtoupper($jtbl->default); goto urKe2; zljgf: crQ4s: goto CL8h7; ajGGc: if (!($jtbl->name == $ftbl->name)) { goto dXrha; } goto tPDbn; ktNau: dXrha: goto V4Bix; oP92d: MVmxQ: goto ktNau; hjPPA: $ftbl->default = str_replace("\50\x29", '', $ftbl->default); goto j90ed; w5YQs: $jtbl->default = str_replace("\50\x29", '', $jtbl->default); goto A5L7W; M9McD: if (!($jtbl->col_type != $ftbl->col_type || $jtbl->nullable != $ftbl->nullable || $jtbl->default != $ftbl->default || $jtbl->extra != $ftbl->extra || $jtbl->comment != $ftbl->comment)) { goto MVmxQ; } goto teeSR; nKWDU: $comment = $jtbl->comment == '' ? '' : "\x20\103\x4f\x4d\x4d\x45\116\124\40\x27" . $jtbl->comment . "\47"; goto ripUd; AEpKq: goto xWsAR; goto N_83v; eYlAd: pglRw: goto q1pk2; iYu0P: if (!($jtbl->nullable != $ftbl->nullable)) { goto NmkYc; } goto lp82m; DM66Q: $extra = $jtbl->extra == '' ? '' : "\x20" . strtoupper($jtbl->extra); goto nKWDU; tPDbn: if (!($jtbl->col_type != $ftbl->col_type)) { goto TEnNZ; } goto sblnC; N_83v: Rf_eD: goto C2gOX; j90ed: $ftbl->default = strtoupper($ftbl->default); goto RCFf6; SHpsb: if (!($jtbl->default != null)) { goto kvX2Y; } goto w5YQs; jFMja: if (strtolower($jtbl->primary) == "\x70\x72\151") { goto pglRw; } goto g4Ucd; GZqZW: if (!($jtbl->default != $ftbl->default)) { goto Sjpfw; } goto Xb21O; teeSR: $nullable = $jtbl->nullable == "\116\117" ? "\40\x4e\x4f\x54\x20\x4e\125\114\x4c" : ''; goto Tpa8f; siqhB: if (!($jtbl->extra != $ftbl->extra)) { goto WQGFa; } goto twFjn; g4Ucd: if (strtolower($jtbl->primary) == "\165\x6e\x69") { goto Rf_eD; } goto gcrta; gcrta: goto xWsAR; goto eYlAd; SexYp: } goto FlGrW; s7_5Z: hINcN: goto jdB6R; a6e3G: $length = ''; goto fV9Wy; FlGrW: sKkOk: goto UczY4; nAjul: if ($jtbl->type != "\x6c\x6f\x6e\x67\164\x65\170\x74" && $jtbl->type != "\155\x65\144\151\165\x6d\x74\x65\170\x74" && $jtbl->type != "\x74\145\170\x74") { goto ki2zo; } goto SL1kh; bKPA6: WDPiq: goto oTFfr; KbKkV: } goto I7Y7x; SmOpp: f5k_V: goto X1rYK; ypJ0j: $add_column = []; goto mwO7m; zKGq5: if (!$this->db->table_exists($table)) { goto zRfz3; } goto HaLN5; X1rYK: VEN0K: goto Xn2Yf; dko2R: if (!(count($modif_column) > 0)) { goto f5k_V; } goto aYHdJ; Aui6p: onLWZ: goto OLUYe; HaLN5: if (!isset($json[$table])) { goto VEN0K; } goto ypJ0j; Tp_UH: bLKZ5: goto dko2R; d1NEf: $script_create_column[$table] = "\x41\x4c\x54\105\122\x20\124\101\x42\114\x45\x20\140" . $table . "\140\x20" . implode("\54\40", $add_column) . "\x3b"; goto Tp_UH; jjEld: $script = "\103\x52\x45\101\x54\105\40\124\101\102\x4c\x45\x20\x60" . $table . "\140\x20\x28"; goto um9w1; j2QTs: $create_tables[] = $json[$table]; goto jjEld; aYHdJ: $script_edit_column[$table] = "\x41\x4c\x54\105\122\x20\124\101\102\114\x45\40\140" . $table . "\x60\40" . implode("\x2c\40", $modif_column) . "\73"; goto SmOpp; BzSu8: zRfz3: goto j2QTs; XtOl7: Ju0AS: goto qEaU7; RmmmN: YcN_X: goto Aui6p; I7Y7x: RFmlz: goto FKWGG; qEaU7: $script .= $pri . "\51\40\105\116\x47\111\x4e\x45\75\111\x6e\x6e\157\104\102\40\104\105\x46\101\x55\114\x54\x20\103\x48\x41\122\123\105\124\75\165\x74\146\x38\x6d\x62\x34\x3b"; goto c_1B2; OLUYe: } goto OYJD8; w3LXD: EtiLK: goto zWu0B; ZBTbx: $json = (array) $json; goto aOSdf; Zj0MS: $script_create_column = []; goto bHUqa; xemfk: $full_tables = array_unique($full_tables); goto NGc5k; jbAGJ: $json = json_decode($json); goto ZBTbx; hndir: $this->db->db_debug = FALSE; goto bIgBi; aOSdf: $tbl_seharusnya = array_keys($json); goto ZWz2M; N8d2d: $this->output_json($data); goto oAWx7; rkcl3: $create_tables = []; goto cCls3; CMfnq: $db_debug = $this->db->db_debug; goto hndir; zWu0B: $json = file_get_contents("\56\x2f\141\x73\163\145\164\x73\57\x61\160\160\x2f\x64\x62\x2f\144\141\x74\141\x62\x61\x73\x65\56\152\x73\157\x6e"); goto jbAGJ; a7sw2: $full_tables = array_merge($tbl_seharusnya, $tbl_ada); goto xemfk; bHUqa: $edit_columns = []; goto DFWN5; cCls3: $script_create_table = []; goto mLW6W; NGc5k: sort($full_tables); goto rkcl3; LaCim: $data = ["\146\x69\145\154\x64\163" => $fields, "\x63\x72\145\x61\164\145\x5f\164\x61\142\154\x65\x73" => $create_tables, "\x63\x6f\165\x6e\164\x5f\x74\x62\x6c" => count($create_tables), "\141\x64\x64\x5f\x63\x6f\154\x75\x6d\156\x73\x5f\x74\157\x5f\164\141\142\154\145" => $add_columns, "\x63\x6f\x75\x6e\x74\137\x63\157\154" => count($add_columns), "\x65\x64\x69\164\x5f\143\x6f\154\165\x6d\156\x73" => $edit_columns, "\143\157\165\x6e\164\x5f\155\x6f\x64" => count($edit_columns), "\x61\144\144\x5f\164\x62\154" => $this->encryption->encrypt(json_encode($script_create_table)), "\x61\x64\144\137\x63\x6f\x6c" => $this->encryption->encrypt(json_encode($script_create_column)), "\155\157\x64\137\143\x6f\x6c" => $this->encryption->encrypt(json_encode($script_edit_column))]; goto N8d2d; XGqQj: $fields = []; goto YzQ8S; ZWz2M: $tbl_ada = array_keys($fields); goto a7sw2; DFWN5: $script_edit_column = []; goto AFfPj; OYJD8: EXHSU: goto DiKzZ; bIgBi: $tabless = $this->db->list_tables(); goto XGqQj; oAWx7: } public function createTable() { goto k5G8D; rW3yK: foreach ($scripts as $script) { $queries .= $script; mwXmC: } goto MhfAL; uSxIR: $data["\x73\x75\143\x63\x65\163\x73"] = $this->runQuery($queries); goto DeUNa; Ezy1n: str_replace("\x25\62\x42", "\x2b", $scripts); goto iyQpd; MhfAL: Lvm0f: goto uSxIR; gzCZP: $scripts = json_decode($this->encryption->decrypt($scripts)); goto sIfVy; DeUNa: $data["\x6d\x65\163\163\141\x67\145"] = "\125\160\x64\x61\x74\145\x20\x6b\157\154\x6f\155"; goto NdIG7; sIfVy: $queries = ''; goto rW3yK; iyQpd: sleep(1); goto gzCZP; NdIG7: $this->output_json($data); goto Y8WmQ; k5G8D: $scripts = $this->input->post("\144\x61\164\x61", true); goto Ezy1n; Y8WmQ: } public function createColumn() { goto m0kvJ; jO2cQ: $queries = ''; goto gQWn1; sdDa2: $this->updateUID(); goto OV3p2; do9tS: if (!(strpos("\x60\x75\x69\144\x60", $queries) !== false)) { goto vUsCx; } goto sdDa2; YBvZk: sleep(1); goto pDlMT; WAoun: $data["\x6d\145\x73\x73\x61\x67\145"] = "\115\x6f\x64\x69\x66\171\x20\x6b\157\154\x6f\155"; goto Dssny; m0kvJ: $scripts = $this->input->post("\x64\x61\x74\141", true); goto h1FZ2; Dssny: $this->output_json($data); goto S8rKg; pDlMT: $scripts = json_decode($this->encryption->decrypt($scripts)); goto jO2cQ; wjoz2: vmeZV: goto do9tS; VyTFE: $data["\x73\165\x63\143\145\x73\163"] = $this->runQuery($queries); goto WAoun; h1FZ2: str_replace("\45\62\102", "\53", $scripts); goto YBvZk; gQWn1: foreach ($scripts as $script) { $queries .= $script; SM3KX: } goto wjoz2; OV3p2: vUsCx: goto VyTFE; S8rKg: } public function editColumn() { goto ju8QE; dwokw: sleep(1); goto DBOLq; jyAd_: $data["\x73\x75\143\143\x65\163\163"] = $this->runQuery($queries); goto MVciO; z9XQB: dgNM8: goto jyAd_; MVciO: $data["\155\x65\x73\163\x61\147\x65"] = "\125\x70\x64\141\164\x65\40\x73\145\x6c\145\163\x61\151"; goto M4Y3j; M4Y3j: $this->output_json($data); goto hgflZ; u4aaH: foreach ($scripts as $script) { $queries .= $script; jnYO9: } goto z9XQB; kCUvg: str_replace("\45\x32\x42", "\53", $scripts); goto dwokw; inMks: $queries = ''; goto u4aaH; ju8QE: $scripts = $this->input->post("\144\x61\164\x61", true); goto kCUvg; DBOLq: $scripts = json_decode($this->encryption->decrypt($scripts)); goto inMks; hgflZ: } function runQuery($script) { goto y55JL; m5Y4A: $mysqli->close(); goto aMQxp; R4ZL_: $mysqli = new mysqli($hostname, $hostuser, $hostpass, $database); goto thacY; R_wuS: $mysqli->multi_query($script); goto m5Y4A; aMQxp: return true; goto TWiPU; eBhRG: return mysqli_connect_errno(); goto xt026; lXUY2: $database = $this->db->database; goto R4ZL_; PdrKW: $hostpass = $this->db->password; goto lXUY2; y55JL: $hostname = $this->db->hostname; goto mwnHb; mwnHb: $hostuser = $this->db->username; goto PdrKW; thacY: if (!mysqli_connect_errno()) { goto ok2O1; } goto eBhRG; xt026: ok2O1: goto R_wuS; TWiPU: } function updateUID() { goto Tx9yy; Tx9yy: $this->load->library("\125\x75\151\x64", "\x75\x75\151\x64"); goto NRHbC; NRHbC: $siswas = $this->db->get("\x6d\x61\x73\164\x65\x72\x5f\x73\151\163\x77\141")->result(); goto KZ4ku; cMrHC: foreach ($siswas as $siswa) { $input[] = array("\x69\144\137\x73\151\163\167\141" => $siswa->id_siswa, "\165\151\144" => $this->uuid->v4()); DXT8d: } goto Ljf3y; Ljf3y: tHemm: goto vr0w0; vr0w0: return $this->db->update_batch("\155\141\163\164\145\x72\x5f\x73\151\x73\167\x61", $input, "\x69\x64\137\163\x69\163\167\141"); goto sJcJx; KZ4ku: $input = array(); goto cMrHC; sJcJx: } function make_base() { } }
